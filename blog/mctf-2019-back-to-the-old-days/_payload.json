[{"data":1,"prerenderedAt":4066},["Reactive",2],{"content-query-Kebqz3p4xB":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"date":10,"image":11,"draft":6,"body":12,"_type":4061,"_id":4062,"_source":4063,"_file":4064,"_extension":4065},"/blog/mctf-2019-back-to-the-old-days","blog",false,"","MCTF Final 2019 Writeup - Back to the Old Ways","There is a group of hackers that we've been trying to take down for a while, we had a spy among them but his cover was compromised, but he managed to leak a piece of code...","2019-07-30T00:00:00.000Z","/img/mctffinal2019.jpg",{"type":13,"children":14,"toc":4057},"root",[15,34,41,46,51,62,68,73,310,315,985,990,999,1013,1018,1023,3836,3841,4037,4051],{"type":16,"tag":17,"props":18,"children":19},"element","p",{},[20,23,32],{"type":21,"value":22},"text","I played MCTF final 2019 with ",{"type":16,"tag":24,"props":25,"children":29},"a",{"href":26,"rel":27},"https://web.facebook.com/sud0r00t/",[28],"nofollow",[30],{"type":21,"value":31},"my team",{"type":21,"value":33}," this week and wanted to share a writeup for the 'Back to the old ways' crypto challenge.",{"type":16,"tag":35,"props":36,"children":38},"h2",{"id":37},"challenge-description",[39],{"type":21,"value":40},"Challenge description",{"type":16,"tag":17,"props":42,"children":43},{},[44],{"type":21,"value":45},"There is a group of hackers that we've been trying to take down for a while, we had a spy among them but his cover was compromised, but he managed to leak a piece of code running on their main socket, try to get admin access.",{"type":16,"tag":17,"props":47,"children":48},{},[49],{"type":21,"value":50},"nc 52.59.5.86 1111",{"type":16,"tag":17,"props":52,"children":53},{},[54,60],{"type":16,"tag":55,"props":56,"children":57},"strong",{},[58],{"type":21,"value":59},"Objective:",{"type":21,"value":61}," Get admin access",{"type":16,"tag":35,"props":63,"children":65},{"id":64},"solution",[66],{"type":21,"value":67},"Solution",{"type":16,"tag":17,"props":69,"children":70},{},[71],{"type":21,"value":72},"I first tried to use the public service",{"type":16,"tag":74,"props":75,"children":79},"pre",{"className":76,"code":77,"language":78,"meta":7,"style":7},"language-bash shiki shiki-themes monokai","[youben@ym ~]$ ncat 52.59.5.86 1111\n[1] register\n[2] login\n1\n[+] name:\nyouben\n[+] password:\npassword\n[+] this is your hex-encoded cookie: 6625205b724457776f2e753f7c3463542a3f584254547d6a77493c0b09714c3a2761476358606a6e45653a5d\n[1] register\n[2] login\n2\n[+] cookie(in hex):\n6625205b724457776f2e753f7c3463542a3f584254547d6a77493c0b09714c3a2761476358606a6e45653a5d\n[-] access is for admins only\n[1] register\n[2] login\n","bash",[80],{"type":16,"tag":81,"props":82,"children":83},"code",{"__ignoreMap":7},[84,107,127,145,155,164,173,182,191,200,216,232,241,250,259,278,294],{"type":16,"tag":85,"props":86,"children":89},"span",{"class":87,"line":88},"line",1,[90,96,102],{"type":16,"tag":85,"props":91,"children":93},{"style":92},"--shiki-default:#F8F8F2",[94],{"type":21,"value":95},"[youben@ym ",{"type":16,"tag":85,"props":97,"children":99},{"style":98},"--shiki-default:#F92672",[100],{"type":21,"value":101},"~",{"type":16,"tag":85,"props":103,"children":104},{"style":92},[105],{"type":21,"value":106},"]$ ncat 52.59.5.86 1111\n",{"type":16,"tag":85,"props":108,"children":110},{"class":87,"line":109},2,[111,116,122],{"type":16,"tag":85,"props":112,"children":113},{"style":92},[114],{"type":21,"value":115},"[",{"type":16,"tag":85,"props":117,"children":119},{"style":118},"--shiki-default:#AE81FF",[120],{"type":21,"value":121},"1",{"type":16,"tag":85,"props":123,"children":124},{"style":92},[125],{"type":21,"value":126},"] register\n",{"type":16,"tag":85,"props":128,"children":130},{"class":87,"line":129},3,[131,135,140],{"type":16,"tag":85,"props":132,"children":133},{"style":92},[134],{"type":21,"value":115},{"type":16,"tag":85,"props":136,"children":137},{"style":118},[138],{"type":21,"value":139},"2",{"type":16,"tag":85,"props":141,"children":142},{"style":92},[143],{"type":21,"value":144},"] login\n",{"type":16,"tag":85,"props":146,"children":148},{"class":87,"line":147},4,[149],{"type":16,"tag":85,"props":150,"children":152},{"style":151},"--shiki-default:#A6E22E",[153],{"type":21,"value":154},"1\n",{"type":16,"tag":85,"props":156,"children":158},{"class":87,"line":157},5,[159],{"type":16,"tag":85,"props":160,"children":161},{"style":92},[162],{"type":21,"value":163},"[+] name:\n",{"type":16,"tag":85,"props":165,"children":167},{"class":87,"line":166},6,[168],{"type":16,"tag":85,"props":169,"children":170},{"style":151},[171],{"type":21,"value":172},"youben\n",{"type":16,"tag":85,"props":174,"children":176},{"class":87,"line":175},7,[177],{"type":16,"tag":85,"props":178,"children":179},{"style":92},[180],{"type":21,"value":181},"[+] password:\n",{"type":16,"tag":85,"props":183,"children":185},{"class":87,"line":184},8,[186],{"type":16,"tag":85,"props":187,"children":188},{"style":151},[189],{"type":21,"value":190},"password\n",{"type":16,"tag":85,"props":192,"children":194},{"class":87,"line":193},9,[195],{"type":16,"tag":85,"props":196,"children":197},{"style":92},[198],{"type":21,"value":199},"[+] this is your hex-encoded cookie: 6625205b724457776f2e753f7c3463542a3f584254547d6a77493c0b09714c3a2761476358606a6e45653a5d\n",{"type":16,"tag":85,"props":201,"children":203},{"class":87,"line":202},10,[204,208,212],{"type":16,"tag":85,"props":205,"children":206},{"style":92},[207],{"type":21,"value":115},{"type":16,"tag":85,"props":209,"children":210},{"style":118},[211],{"type":21,"value":121},{"type":16,"tag":85,"props":213,"children":214},{"style":92},[215],{"type":21,"value":126},{"type":16,"tag":85,"props":217,"children":219},{"class":87,"line":218},11,[220,224,228],{"type":16,"tag":85,"props":221,"children":222},{"style":92},[223],{"type":21,"value":115},{"type":16,"tag":85,"props":225,"children":226},{"style":118},[227],{"type":21,"value":139},{"type":16,"tag":85,"props":229,"children":230},{"style":92},[231],{"type":21,"value":144},{"type":16,"tag":85,"props":233,"children":235},{"class":87,"line":234},12,[236],{"type":16,"tag":85,"props":237,"children":238},{"style":151},[239],{"type":21,"value":240},"2\n",{"type":16,"tag":85,"props":242,"children":244},{"class":87,"line":243},13,[245],{"type":16,"tag":85,"props":246,"children":247},{"style":92},[248],{"type":21,"value":249},"[+] cookie(in hex):\n",{"type":16,"tag":85,"props":251,"children":253},{"class":87,"line":252},14,[254],{"type":16,"tag":85,"props":255,"children":256},{"style":151},[257],{"type":21,"value":258},"6625205b724457776f2e753f7c3463542a3f584254547d6a77493c0b09714c3a2761476358606a6e45653a5d\n",{"type":16,"tag":85,"props":260,"children":262},{"class":87,"line":261},15,[263,268,273],{"type":16,"tag":85,"props":264,"children":265},{"style":92},[266],{"type":21,"value":267},"[-] access is ",{"type":16,"tag":85,"props":269,"children":270},{"style":98},[271],{"type":21,"value":272},"for",{"type":16,"tag":85,"props":274,"children":275},{"style":92},[276],{"type":21,"value":277}," admins only\n",{"type":16,"tag":85,"props":279,"children":281},{"class":87,"line":280},16,[282,286,290],{"type":16,"tag":85,"props":283,"children":284},{"style":92},[285],{"type":21,"value":115},{"type":16,"tag":85,"props":287,"children":288},{"style":118},[289],{"type":21,"value":121},{"type":16,"tag":85,"props":291,"children":292},{"style":92},[293],{"type":21,"value":126},{"type":16,"tag":85,"props":295,"children":297},{"class":87,"line":296},17,[298,302,306],{"type":16,"tag":85,"props":299,"children":300},{"style":92},[301],{"type":21,"value":115},{"type":16,"tag":85,"props":303,"children":304},{"style":118},[305],{"type":21,"value":139},{"type":16,"tag":85,"props":307,"children":308},{"style":92},[309],{"type":21,"value":144},{"type":16,"tag":17,"props":311,"children":312},{},[313],{"type":21,"value":314},"It seems like our information are stored in that cookie and are checked when we try to login to see if we have admin rights. So the goal is to construct a valid admin cookie. Let's check the provided code",{"type":16,"tag":74,"props":316,"children":320},{"className":317,"code":318,"language":319,"meta":7,"style":7},"language-python shiki shiki-themes monokai","#all what u need is here\n\nfrom string import printable as alpha\n\ndef encrypt(msg,key,iv):\n    if len(msg) % 11 != 0:\n        msg += alpha[len(msg) % 11] * (11 - len(msg) % 11)\n    l = [msg[i:i+11] for i in range(0,len(msg),11)]\n    ct = []\n    for i in l:\n        tmp = viginereEncrypt(i,iv)\n        tmp = railFenceEncrypt(tmp,key)\n        ct.append(tmp)\n        iv = tmp\n    return ''.join(ct)\n\ndef decrypt(msg,key,iv):\n    l = [msg[i:i+11] for i in range(0,len(msg),11)]\n    pt = []\n    for i in l:\n        tmp = railFenceDecrypt(i,key)\n        tmp = viginereDecrypt(tmp,iv)\n        pt.append(tmp)\n        iv = i\n    return ''.join(pt)\n","python",[321],{"type":16,"tag":81,"props":322,"children":323},{"__ignoreMap":7},[324,333,342,375,382,431,475,556,637,654,675,692,708,716,733,752,759,799,871,888,908,925,942,951,968],{"type":16,"tag":85,"props":325,"children":326},{"class":87,"line":88},[327],{"type":16,"tag":85,"props":328,"children":330},{"style":329},"--shiki-default:#88846F",[331],{"type":21,"value":332},"#all what u need is here\n",{"type":16,"tag":85,"props":334,"children":335},{"class":87,"line":109},[336],{"type":16,"tag":85,"props":337,"children":339},{"emptyLinePlaceholder":338},true,[340],{"type":21,"value":341},"\n",{"type":16,"tag":85,"props":343,"children":344},{"class":87,"line":129},[345,350,355,360,365,370],{"type":16,"tag":85,"props":346,"children":347},{"style":98},[348],{"type":21,"value":349},"from",{"type":16,"tag":85,"props":351,"children":352},{"style":92},[353],{"type":21,"value":354}," string ",{"type":16,"tag":85,"props":356,"children":357},{"style":98},[358],{"type":21,"value":359},"import",{"type":16,"tag":85,"props":361,"children":362},{"style":92},[363],{"type":21,"value":364}," printable ",{"type":16,"tag":85,"props":366,"children":367},{"style":98},[368],{"type":21,"value":369},"as",{"type":16,"tag":85,"props":371,"children":372},{"style":92},[373],{"type":21,"value":374}," alpha\n",{"type":16,"tag":85,"props":376,"children":377},{"class":87,"line":147},[378],{"type":16,"tag":85,"props":379,"children":380},{"emptyLinePlaceholder":338},[381],{"type":21,"value":341},{"type":16,"tag":85,"props":383,"children":384},{"class":87,"line":157},[385,391,396,401,407,412,417,421,426],{"type":16,"tag":85,"props":386,"children":388},{"style":387},"--shiki-default:#66D9EF;--shiki-default-font-style:italic",[389],{"type":21,"value":390},"def",{"type":16,"tag":85,"props":392,"children":393},{"style":151},[394],{"type":21,"value":395}," encrypt",{"type":16,"tag":85,"props":397,"children":398},{"style":92},[399],{"type":21,"value":400},"(",{"type":16,"tag":85,"props":402,"children":404},{"style":403},"--shiki-default:#FD971F;--shiki-default-font-style:italic",[405],{"type":21,"value":406},"msg",{"type":16,"tag":85,"props":408,"children":409},{"style":92},[410],{"type":21,"value":411},",",{"type":16,"tag":85,"props":413,"children":414},{"style":403},[415],{"type":21,"value":416},"key",{"type":16,"tag":85,"props":418,"children":419},{"style":92},[420],{"type":21,"value":411},{"type":16,"tag":85,"props":422,"children":423},{"style":403},[424],{"type":21,"value":425},"iv",{"type":16,"tag":85,"props":427,"children":428},{"style":92},[429],{"type":21,"value":430},"):\n",{"type":16,"tag":85,"props":432,"children":433},{"class":87,"line":166},[434,439,445,450,455,460,465,470],{"type":16,"tag":85,"props":435,"children":436},{"style":98},[437],{"type":21,"value":438},"    if",{"type":16,"tag":85,"props":440,"children":442},{"style":441},"--shiki-default:#66D9EF",[443],{"type":21,"value":444}," len",{"type":16,"tag":85,"props":446,"children":447},{"style":92},[448],{"type":21,"value":449},"(msg) ",{"type":16,"tag":85,"props":451,"children":452},{"style":98},[453],{"type":21,"value":454},"%",{"type":16,"tag":85,"props":456,"children":457},{"style":118},[458],{"type":21,"value":459}," 11",{"type":16,"tag":85,"props":461,"children":462},{"style":98},[463],{"type":21,"value":464}," !=",{"type":16,"tag":85,"props":466,"children":467},{"style":118},[468],{"type":21,"value":469}," 0",{"type":16,"tag":85,"props":471,"children":472},{"style":92},[473],{"type":21,"value":474},":\n",{"type":16,"tag":85,"props":476,"children":477},{"class":87,"line":175},[478,483,488,493,498,502,506,510,515,520,525,530,535,539,543,547,551],{"type":16,"tag":85,"props":479,"children":480},{"style":92},[481],{"type":21,"value":482},"        msg ",{"type":16,"tag":85,"props":484,"children":485},{"style":98},[486],{"type":21,"value":487},"+=",{"type":16,"tag":85,"props":489,"children":490},{"style":92},[491],{"type":21,"value":492}," alpha[",{"type":16,"tag":85,"props":494,"children":495},{"style":441},[496],{"type":21,"value":497},"len",{"type":16,"tag":85,"props":499,"children":500},{"style":92},[501],{"type":21,"value":449},{"type":16,"tag":85,"props":503,"children":504},{"style":98},[505],{"type":21,"value":454},{"type":16,"tag":85,"props":507,"children":508},{"style":118},[509],{"type":21,"value":459},{"type":16,"tag":85,"props":511,"children":512},{"style":92},[513],{"type":21,"value":514},"] ",{"type":16,"tag":85,"props":516,"children":517},{"style":98},[518],{"type":21,"value":519},"*",{"type":16,"tag":85,"props":521,"children":522},{"style":92},[523],{"type":21,"value":524}," (",{"type":16,"tag":85,"props":526,"children":527},{"style":118},[528],{"type":21,"value":529},"11",{"type":16,"tag":85,"props":531,"children":532},{"style":98},[533],{"type":21,"value":534}," -",{"type":16,"tag":85,"props":536,"children":537},{"style":441},[538],{"type":21,"value":444},{"type":16,"tag":85,"props":540,"children":541},{"style":92},[542],{"type":21,"value":449},{"type":16,"tag":85,"props":544,"children":545},{"style":98},[546],{"type":21,"value":454},{"type":16,"tag":85,"props":548,"children":549},{"style":118},[550],{"type":21,"value":459},{"type":16,"tag":85,"props":552,"children":553},{"style":92},[554],{"type":21,"value":555},")\n",{"type":16,"tag":85,"props":557,"children":558},{"class":87,"line":184},[559,564,569,574,579,583,587,591,596,601,606,610,615,619,623,628,632],{"type":16,"tag":85,"props":560,"children":561},{"style":92},[562],{"type":21,"value":563},"    l ",{"type":16,"tag":85,"props":565,"children":566},{"style":98},[567],{"type":21,"value":568},"=",{"type":16,"tag":85,"props":570,"children":571},{"style":92},[572],{"type":21,"value":573}," [msg[i:i",{"type":16,"tag":85,"props":575,"children":576},{"style":98},[577],{"type":21,"value":578},"+",{"type":16,"tag":85,"props":580,"children":581},{"style":118},[582],{"type":21,"value":529},{"type":16,"tag":85,"props":584,"children":585},{"style":92},[586],{"type":21,"value":514},{"type":16,"tag":85,"props":588,"children":589},{"style":98},[590],{"type":21,"value":272},{"type":16,"tag":85,"props":592,"children":593},{"style":92},[594],{"type":21,"value":595}," i ",{"type":16,"tag":85,"props":597,"children":598},{"style":98},[599],{"type":21,"value":600},"in",{"type":16,"tag":85,"props":602,"children":603},{"style":441},[604],{"type":21,"value":605}," range",{"type":16,"tag":85,"props":607,"children":608},{"style":92},[609],{"type":21,"value":400},{"type":16,"tag":85,"props":611,"children":612},{"style":118},[613],{"type":21,"value":614},"0",{"type":16,"tag":85,"props":616,"children":617},{"style":92},[618],{"type":21,"value":411},{"type":16,"tag":85,"props":620,"children":621},{"style":441},[622],{"type":21,"value":497},{"type":16,"tag":85,"props":624,"children":625},{"style":92},[626],{"type":21,"value":627},"(msg),",{"type":16,"tag":85,"props":629,"children":630},{"style":118},[631],{"type":21,"value":529},{"type":16,"tag":85,"props":633,"children":634},{"style":92},[635],{"type":21,"value":636},")]\n",{"type":16,"tag":85,"props":638,"children":639},{"class":87,"line":193},[640,645,649],{"type":16,"tag":85,"props":641,"children":642},{"style":92},[643],{"type":21,"value":644},"    ct ",{"type":16,"tag":85,"props":646,"children":647},{"style":98},[648],{"type":21,"value":568},{"type":16,"tag":85,"props":650,"children":651},{"style":92},[652],{"type":21,"value":653}," []\n",{"type":16,"tag":85,"props":655,"children":656},{"class":87,"line":202},[657,662,666,670],{"type":16,"tag":85,"props":658,"children":659},{"style":98},[660],{"type":21,"value":661},"    for",{"type":16,"tag":85,"props":663,"children":664},{"style":92},[665],{"type":21,"value":595},{"type":16,"tag":85,"props":667,"children":668},{"style":98},[669],{"type":21,"value":600},{"type":16,"tag":85,"props":671,"children":672},{"style":92},[673],{"type":21,"value":674}," l:\n",{"type":16,"tag":85,"props":676,"children":677},{"class":87,"line":218},[678,683,687],{"type":16,"tag":85,"props":679,"children":680},{"style":92},[681],{"type":21,"value":682},"        tmp ",{"type":16,"tag":85,"props":684,"children":685},{"style":98},[686],{"type":21,"value":568},{"type":16,"tag":85,"props":688,"children":689},{"style":92},[690],{"type":21,"value":691}," viginereEncrypt(i,iv)\n",{"type":16,"tag":85,"props":693,"children":694},{"class":87,"line":234},[695,699,703],{"type":16,"tag":85,"props":696,"children":697},{"style":92},[698],{"type":21,"value":682},{"type":16,"tag":85,"props":700,"children":701},{"style":98},[702],{"type":21,"value":568},{"type":16,"tag":85,"props":704,"children":705},{"style":92},[706],{"type":21,"value":707}," railFenceEncrypt(tmp,key)\n",{"type":16,"tag":85,"props":709,"children":710},{"class":87,"line":243},[711],{"type":16,"tag":85,"props":712,"children":713},{"style":92},[714],{"type":21,"value":715},"        ct.append(tmp)\n",{"type":16,"tag":85,"props":717,"children":718},{"class":87,"line":252},[719,724,728],{"type":16,"tag":85,"props":720,"children":721},{"style":92},[722],{"type":21,"value":723},"        iv ",{"type":16,"tag":85,"props":725,"children":726},{"style":98},[727],{"type":21,"value":568},{"type":16,"tag":85,"props":729,"children":730},{"style":92},[731],{"type":21,"value":732}," tmp\n",{"type":16,"tag":85,"props":734,"children":735},{"class":87,"line":261},[736,741,747],{"type":16,"tag":85,"props":737,"children":738},{"style":98},[739],{"type":21,"value":740},"    return",{"type":16,"tag":85,"props":742,"children":744},{"style":743},"--shiki-default:#E6DB74",[745],{"type":21,"value":746}," ''",{"type":16,"tag":85,"props":748,"children":749},{"style":92},[750],{"type":21,"value":751},".join(ct)\n",{"type":16,"tag":85,"props":753,"children":754},{"class":87,"line":280},[755],{"type":16,"tag":85,"props":756,"children":757},{"emptyLinePlaceholder":338},[758],{"type":21,"value":341},{"type":16,"tag":85,"props":760,"children":761},{"class":87,"line":296},[762,766,771,775,779,783,787,791,795],{"type":16,"tag":85,"props":763,"children":764},{"style":387},[765],{"type":21,"value":390},{"type":16,"tag":85,"props":767,"children":768},{"style":151},[769],{"type":21,"value":770}," decrypt",{"type":16,"tag":85,"props":772,"children":773},{"style":92},[774],{"type":21,"value":400},{"type":16,"tag":85,"props":776,"children":777},{"style":403},[778],{"type":21,"value":406},{"type":16,"tag":85,"props":780,"children":781},{"style":92},[782],{"type":21,"value":411},{"type":16,"tag":85,"props":784,"children":785},{"style":403},[786],{"type":21,"value":416},{"type":16,"tag":85,"props":788,"children":789},{"style":92},[790],{"type":21,"value":411},{"type":16,"tag":85,"props":792,"children":793},{"style":403},[794],{"type":21,"value":425},{"type":16,"tag":85,"props":796,"children":797},{"style":92},[798],{"type":21,"value":430},{"type":16,"tag":85,"props":800,"children":802},{"class":87,"line":801},18,[803,807,811,815,819,823,827,831,835,839,843,847,851,855,859,863,867],{"type":16,"tag":85,"props":804,"children":805},{"style":92},[806],{"type":21,"value":563},{"type":16,"tag":85,"props":808,"children":809},{"style":98},[810],{"type":21,"value":568},{"type":16,"tag":85,"props":812,"children":813},{"style":92},[814],{"type":21,"value":573},{"type":16,"tag":85,"props":816,"children":817},{"style":98},[818],{"type":21,"value":578},{"type":16,"tag":85,"props":820,"children":821},{"style":118},[822],{"type":21,"value":529},{"type":16,"tag":85,"props":824,"children":825},{"style":92},[826],{"type":21,"value":514},{"type":16,"tag":85,"props":828,"children":829},{"style":98},[830],{"type":21,"value":272},{"type":16,"tag":85,"props":832,"children":833},{"style":92},[834],{"type":21,"value":595},{"type":16,"tag":85,"props":836,"children":837},{"style":98},[838],{"type":21,"value":600},{"type":16,"tag":85,"props":840,"children":841},{"style":441},[842],{"type":21,"value":605},{"type":16,"tag":85,"props":844,"children":845},{"style":92},[846],{"type":21,"value":400},{"type":16,"tag":85,"props":848,"children":849},{"style":118},[850],{"type":21,"value":614},{"type":16,"tag":85,"props":852,"children":853},{"style":92},[854],{"type":21,"value":411},{"type":16,"tag":85,"props":856,"children":857},{"style":441},[858],{"type":21,"value":497},{"type":16,"tag":85,"props":860,"children":861},{"style":92},[862],{"type":21,"value":627},{"type":16,"tag":85,"props":864,"children":865},{"style":118},[866],{"type":21,"value":529},{"type":16,"tag":85,"props":868,"children":869},{"style":92},[870],{"type":21,"value":636},{"type":16,"tag":85,"props":872,"children":874},{"class":87,"line":873},19,[875,880,884],{"type":16,"tag":85,"props":876,"children":877},{"style":92},[878],{"type":21,"value":879},"    pt ",{"type":16,"tag":85,"props":881,"children":882},{"style":98},[883],{"type":21,"value":568},{"type":16,"tag":85,"props":885,"children":886},{"style":92},[887],{"type":21,"value":653},{"type":16,"tag":85,"props":889,"children":891},{"class":87,"line":890},20,[892,896,900,904],{"type":16,"tag":85,"props":893,"children":894},{"style":98},[895],{"type":21,"value":661},{"type":16,"tag":85,"props":897,"children":898},{"style":92},[899],{"type":21,"value":595},{"type":16,"tag":85,"props":901,"children":902},{"style":98},[903],{"type":21,"value":600},{"type":16,"tag":85,"props":905,"children":906},{"style":92},[907],{"type":21,"value":674},{"type":16,"tag":85,"props":909,"children":911},{"class":87,"line":910},21,[912,916,920],{"type":16,"tag":85,"props":913,"children":914},{"style":92},[915],{"type":21,"value":682},{"type":16,"tag":85,"props":917,"children":918},{"style":98},[919],{"type":21,"value":568},{"type":16,"tag":85,"props":921,"children":922},{"style":92},[923],{"type":21,"value":924}," railFenceDecrypt(i,key)\n",{"type":16,"tag":85,"props":926,"children":928},{"class":87,"line":927},22,[929,933,937],{"type":16,"tag":85,"props":930,"children":931},{"style":92},[932],{"type":21,"value":682},{"type":16,"tag":85,"props":934,"children":935},{"style":98},[936],{"type":21,"value":568},{"type":16,"tag":85,"props":938,"children":939},{"style":92},[940],{"type":21,"value":941}," viginereDecrypt(tmp,iv)\n",{"type":16,"tag":85,"props":943,"children":945},{"class":87,"line":944},23,[946],{"type":16,"tag":85,"props":947,"children":948},{"style":92},[949],{"type":21,"value":950},"        pt.append(tmp)\n",{"type":16,"tag":85,"props":952,"children":954},{"class":87,"line":953},24,[955,959,963],{"type":16,"tag":85,"props":956,"children":957},{"style":92},[958],{"type":21,"value":723},{"type":16,"tag":85,"props":960,"children":961},{"style":98},[962],{"type":21,"value":568},{"type":16,"tag":85,"props":964,"children":965},{"style":92},[966],{"type":21,"value":967}," i\n",{"type":16,"tag":85,"props":969,"children":971},{"class":87,"line":970},25,[972,976,980],{"type":16,"tag":85,"props":973,"children":974},{"style":98},[975],{"type":21,"value":740},{"type":16,"tag":85,"props":977,"children":978},{"style":743},[979],{"type":21,"value":746},{"type":16,"tag":85,"props":981,"children":982},{"style":92},[983],{"type":21,"value":984},".join(pt)\n",{"type":16,"tag":17,"props":986,"children":987},{},[988],{"type":21,"value":989},"The encryption can be illustrated in the figure below",{"type":16,"tag":17,"props":991,"children":992},{},[993],{"type":16,"tag":994,"props":995,"children":998},"img",{"alt":996,"src":997},"cbc","/img/cbc.png",[],{"type":16,"tag":17,"props":1000,"children":1001},{},[1002,1004,1011],{"type":21,"value":1003},"It's using vigenere and railfence in ",{"type":16,"tag":24,"props":1005,"children":1008},{"href":1006,"rel":1007},"https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation",[28],[1009],{"type":21,"value":1010},"CBC",{"type":21,"value":1012}," mode, the keyspace for railfence here is computable (only 10 possible keys), so if we know the last plaintext then we can just try decrypting the last ciphertext with the possible keys until we found the correct one that decrypts to our know plaintext, thanks to the padding for that, if len(plaintext) % 11 == 1 then it will be padded with 10 '1', however, we must first understand how it's constructing the plaintext cookie.",{"type":16,"tag":17,"props":1014,"children":1015},{},[1016],{"type":21,"value":1017},"Trying different inputs, I discovered that a name and password of length 6 + 11k gives us a padding of 10 '1', so we can now decrypt the last block with the 10 possible keys and check until we get those 10 '1' and decrypt the whole cookie except the first block cause we don't have the IV.",{"type":16,"tag":17,"props":1019,"children":1020},{},[1021],{"type":21,"value":1022},"Decrypting the cookie gave me '](yv$zHX?B)&password=&admin=false&1111111111', seems like we only need to replace that 'false' with a 'true' and reconstruct a valid cookie. You can check the complete code for doing that below",{"type":16,"tag":74,"props":1024,"children":1026},{"className":317,"code":1025,"language":319,"meta":7,"style":7},"from string import printable as alpha\nfrom binascii import unhexlify, hexlify\n\n\ndef encryptRailFence(text, key):\n    rail = [['\\n' for i in range(len(text))]\n                  for j in range(key)]\n    dir_down = False\n    row, col = 0, 0\n\n    for i in range(len(text)):\n        if (row == 0) or (row == key - 1):\n            dir_down = not dir_down\n\n        rail[row][col] = text[i]\n        col += 1\n        if dir_down:\n            row += 1\n        else:\n            row -= 1\n    result = []\n    for i in range(key):\n        for j in range(len(text)):\n            if rail[i][j] != '\\n':\n                result.append(rail[i][j])\n    return(\"\" . join(result))\n\n\ndef decryptRailFence(cipher, key):\n    rail = [['\\n' for i in range(len(cipher))]\n                  for j in range(key)]\n    dir_down = None\n    row, col = 0, 0\n\n    for i in range(len(cipher)):\n        if row == 0:\n            dir_down = True\n        if row == key - 1:\n            dir_down = False\n\n        rail[row][col] = '*'\n        col += 1\n\n        if dir_down:\n            row += 1\n        else:\n            row -= 1\n    index = 0\n    for i in range(key):\n        for j in range(len(cipher)):\n            if ((rail[i][j] == '*') and\n               (index \u003C len(cipher))):\n                rail[i][j] = cipher[index]\n                index += 1\n    result = []\n    row, col = 0, 0\n    for i in range(len(cipher)):\n        if row == 0:\n            dir_down = True\n        if row == key-1:\n            dir_down = False\n        if (rail[row][col] != '*'):\n            result.append(rail[row][col])\n            col += 1\n        if dir_down:\n            row += 1\n        else:\n            row -= 1\n    return(\"\".join(result))\n\n\ndef decryptVig(ciphertext, key):\n    key_length = len(key)\n    key_as_int = [alpha.find(k) for k in key]\n    ciphertext_int = [alpha.find(c) for c in ciphertext]\n    plaintext = ''\n    for i in range(len(ciphertext_int)):\n        p = (ciphertext_int[i] - key_as_int[i % key_length]) % len(alpha)\n        plaintext += alpha[p]\n    return plaintext\n\n\ndef encryptVig(plaintext, key):\n    key_length = len(key)\n    key_as_int = [alpha.find(k) for k in key]\n    plaintext_int = [alpha.find(p) for p in plaintext]\n    ciphertext = ''\n    for i in range(len(plaintext_int)):\n        c = (plaintext_int[i] + key_as_int[i % key_length]) % len(alpha)\n        ciphertext += alpha[c]\n    return ciphertext\n\n\ndef decrypt(msg,key,iv):\n    l = [msg[i:i+11] for i in range(0,len(msg),11)]\n    pt = []\n    for i in l:\n        tmp = decryptRailFence(i,key)\n        tmp = decryptVig(tmp,iv)\n        pt.append(tmp)\n        iv = i\n    return ''.join(pt)\n\n\nif __name__ == '__main__':\n    # name: 'aaaaaa'\n    # password: ''\n    expected_chars = '1' * 10\n    cookie = \"2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d7a73530c0b66227736200b4174540c30\"\n    cipher = unhexlify(cookie).decode()\n    ciphers = [cipher[i:i+11] for i in range(0, len(cipher), 11)]\n    last_cipher = ciphers[-1]\n    rf_key = -1\n    for i in range(2, 11):\n        p = decryptRailFence(last_cipher, i)\n        p = decryptVig(p, ciphers[-2])\n        if expected_chars in p:\n            print(\"Found RF key: %d\" % i)\n            rf_key = i\n    print(decrypt(cipher, rf_key, \"0\"))\n    admin_val = \"admin=true&\"\n    # construct the admin cookie\n    cons = encryptVig(admin_val, ciphers[-3])\n    cons = encryptRailFence(cons, rf_key)\n    ciphers[-2] = cons\n    # print admin cookie\n    print(hexlify(''.join(ciphers[:-1]).encode()))\n",[1027],{"type":16,"tag":81,"props":1028,"children":1029},{"__ignoreMap":7},[1030,1057,1078,1085,1092,1125,1186,1212,1229,1254,1261,1293,1352,1374,1381,1398,1415,1427,1443,1455,1471,1487,1511,1543,1578,1586,1608,1616,1624,1658,1715,1739,1756,1780,1788,1821,1846,1863,1895,1911,1919,1936,1952,1960,1972,1988,2000,2016,2034,2058,2090,2121,2144,2162,2179,2195,2219,2251,2275,2291,2324,2340,2365,2374,2391,2403,2419,2431,2447,2468,2476,2484,2518,2540,2576,2612,2630,2663,2712,2730,2743,2751,2759,2793,2813,2845,2881,2898,2931,2977,2995,3008,3016,3024,3064,3136,3152,3172,3189,3206,3214,3230,3246,3254,3262,3289,3298,3307,3335,3353,3371,3446,3477,3498,3538,3555,3585,3607,3645,3662,3686,3704,3713,3744,3761,3791,3800],{"type":16,"tag":85,"props":1031,"children":1032},{"class":87,"line":88},[1033,1037,1041,1045,1049,1053],{"type":16,"tag":85,"props":1034,"children":1035},{"style":98},[1036],{"type":21,"value":349},{"type":16,"tag":85,"props":1038,"children":1039},{"style":92},[1040],{"type":21,"value":354},{"type":16,"tag":85,"props":1042,"children":1043},{"style":98},[1044],{"type":21,"value":359},{"type":16,"tag":85,"props":1046,"children":1047},{"style":92},[1048],{"type":21,"value":364},{"type":16,"tag":85,"props":1050,"children":1051},{"style":98},[1052],{"type":21,"value":369},{"type":16,"tag":85,"props":1054,"children":1055},{"style":92},[1056],{"type":21,"value":374},{"type":16,"tag":85,"props":1058,"children":1059},{"class":87,"line":109},[1060,1064,1069,1073],{"type":16,"tag":85,"props":1061,"children":1062},{"style":98},[1063],{"type":21,"value":349},{"type":16,"tag":85,"props":1065,"children":1066},{"style":92},[1067],{"type":21,"value":1068}," binascii ",{"type":16,"tag":85,"props":1070,"children":1071},{"style":98},[1072],{"type":21,"value":359},{"type":16,"tag":85,"props":1074,"children":1075},{"style":92},[1076],{"type":21,"value":1077}," unhexlify, hexlify\n",{"type":16,"tag":85,"props":1079,"children":1080},{"class":87,"line":129},[1081],{"type":16,"tag":85,"props":1082,"children":1083},{"emptyLinePlaceholder":338},[1084],{"type":21,"value":341},{"type":16,"tag":85,"props":1086,"children":1087},{"class":87,"line":147},[1088],{"type":16,"tag":85,"props":1089,"children":1090},{"emptyLinePlaceholder":338},[1091],{"type":21,"value":341},{"type":16,"tag":85,"props":1093,"children":1094},{"class":87,"line":157},[1095,1099,1104,1108,1112,1117,1121],{"type":16,"tag":85,"props":1096,"children":1097},{"style":387},[1098],{"type":21,"value":390},{"type":16,"tag":85,"props":1100,"children":1101},{"style":151},[1102],{"type":21,"value":1103}," encryptRailFence",{"type":16,"tag":85,"props":1105,"children":1106},{"style":92},[1107],{"type":21,"value":400},{"type":16,"tag":85,"props":1109,"children":1110},{"style":403},[1111],{"type":21,"value":21},{"type":16,"tag":85,"props":1113,"children":1114},{"style":92},[1115],{"type":21,"value":1116},", ",{"type":16,"tag":85,"props":1118,"children":1119},{"style":403},[1120],{"type":21,"value":416},{"type":16,"tag":85,"props":1122,"children":1123},{"style":92},[1124],{"type":21,"value":430},{"type":16,"tag":85,"props":1126,"children":1127},{"class":87,"line":166},[1128,1133,1137,1142,1147,1152,1156,1161,1165,1169,1173,1177,1181],{"type":16,"tag":85,"props":1129,"children":1130},{"style":92},[1131],{"type":21,"value":1132},"    rail ",{"type":16,"tag":85,"props":1134,"children":1135},{"style":98},[1136],{"type":21,"value":568},{"type":16,"tag":85,"props":1138,"children":1139},{"style":92},[1140],{"type":21,"value":1141}," [[",{"type":16,"tag":85,"props":1143,"children":1144},{"style":743},[1145],{"type":21,"value":1146},"'",{"type":16,"tag":85,"props":1148,"children":1149},{"style":118},[1150],{"type":21,"value":1151},"\\n",{"type":16,"tag":85,"props":1153,"children":1154},{"style":743},[1155],{"type":21,"value":1146},{"type":16,"tag":85,"props":1157,"children":1158},{"style":98},[1159],{"type":21,"value":1160}," for",{"type":16,"tag":85,"props":1162,"children":1163},{"style":92},[1164],{"type":21,"value":595},{"type":16,"tag":85,"props":1166,"children":1167},{"style":98},[1168],{"type":21,"value":600},{"type":16,"tag":85,"props":1170,"children":1171},{"style":441},[1172],{"type":21,"value":605},{"type":16,"tag":85,"props":1174,"children":1175},{"style":92},[1176],{"type":21,"value":400},{"type":16,"tag":85,"props":1178,"children":1179},{"style":441},[1180],{"type":21,"value":497},{"type":16,"tag":85,"props":1182,"children":1183},{"style":92},[1184],{"type":21,"value":1185},"(text))]\n",{"type":16,"tag":85,"props":1187,"children":1188},{"class":87,"line":175},[1189,1194,1199,1203,1207],{"type":16,"tag":85,"props":1190,"children":1191},{"style":98},[1192],{"type":21,"value":1193},"                  for",{"type":16,"tag":85,"props":1195,"children":1196},{"style":92},[1197],{"type":21,"value":1198}," j ",{"type":16,"tag":85,"props":1200,"children":1201},{"style":98},[1202],{"type":21,"value":600},{"type":16,"tag":85,"props":1204,"children":1205},{"style":441},[1206],{"type":21,"value":605},{"type":16,"tag":85,"props":1208,"children":1209},{"style":92},[1210],{"type":21,"value":1211},"(key)]\n",{"type":16,"tag":85,"props":1213,"children":1214},{"class":87,"line":184},[1215,1220,1224],{"type":16,"tag":85,"props":1216,"children":1217},{"style":92},[1218],{"type":21,"value":1219},"    dir_down ",{"type":16,"tag":85,"props":1221,"children":1222},{"style":98},[1223],{"type":21,"value":568},{"type":16,"tag":85,"props":1225,"children":1226},{"style":118},[1227],{"type":21,"value":1228}," False\n",{"type":16,"tag":85,"props":1230,"children":1231},{"class":87,"line":193},[1232,1237,1241,1245,1249],{"type":16,"tag":85,"props":1233,"children":1234},{"style":92},[1235],{"type":21,"value":1236},"    row, col ",{"type":16,"tag":85,"props":1238,"children":1239},{"style":98},[1240],{"type":21,"value":568},{"type":16,"tag":85,"props":1242,"children":1243},{"style":118},[1244],{"type":21,"value":469},{"type":16,"tag":85,"props":1246,"children":1247},{"style":92},[1248],{"type":21,"value":1116},{"type":16,"tag":85,"props":1250,"children":1251},{"style":118},[1252],{"type":21,"value":1253},"0\n",{"type":16,"tag":85,"props":1255,"children":1256},{"class":87,"line":202},[1257],{"type":16,"tag":85,"props":1258,"children":1259},{"emptyLinePlaceholder":338},[1260],{"type":21,"value":341},{"type":16,"tag":85,"props":1262,"children":1263},{"class":87,"line":218},[1264,1268,1272,1276,1280,1284,1288],{"type":16,"tag":85,"props":1265,"children":1266},{"style":98},[1267],{"type":21,"value":661},{"type":16,"tag":85,"props":1269,"children":1270},{"style":92},[1271],{"type":21,"value":595},{"type":16,"tag":85,"props":1273,"children":1274},{"style":98},[1275],{"type":21,"value":600},{"type":16,"tag":85,"props":1277,"children":1278},{"style":441},[1279],{"type":21,"value":605},{"type":16,"tag":85,"props":1281,"children":1282},{"style":92},[1283],{"type":21,"value":400},{"type":16,"tag":85,"props":1285,"children":1286},{"style":441},[1287],{"type":21,"value":497},{"type":16,"tag":85,"props":1289,"children":1290},{"style":92},[1291],{"type":21,"value":1292},"(text)):\n",{"type":16,"tag":85,"props":1294,"children":1295},{"class":87,"line":234},[1296,1301,1306,1311,1315,1320,1325,1329,1333,1338,1343,1348],{"type":16,"tag":85,"props":1297,"children":1298},{"style":98},[1299],{"type":21,"value":1300},"        if",{"type":16,"tag":85,"props":1302,"children":1303},{"style":92},[1304],{"type":21,"value":1305}," (row ",{"type":16,"tag":85,"props":1307,"children":1308},{"style":98},[1309],{"type":21,"value":1310},"==",{"type":16,"tag":85,"props":1312,"children":1313},{"style":118},[1314],{"type":21,"value":469},{"type":16,"tag":85,"props":1316,"children":1317},{"style":92},[1318],{"type":21,"value":1319},") ",{"type":16,"tag":85,"props":1321,"children":1322},{"style":98},[1323],{"type":21,"value":1324},"or",{"type":16,"tag":85,"props":1326,"children":1327},{"style":92},[1328],{"type":21,"value":1305},{"type":16,"tag":85,"props":1330,"children":1331},{"style":98},[1332],{"type":21,"value":1310},{"type":16,"tag":85,"props":1334,"children":1335},{"style":92},[1336],{"type":21,"value":1337}," key ",{"type":16,"tag":85,"props":1339,"children":1340},{"style":98},[1341],{"type":21,"value":1342},"-",{"type":16,"tag":85,"props":1344,"children":1345},{"style":118},[1346],{"type":21,"value":1347}," 1",{"type":16,"tag":85,"props":1349,"children":1350},{"style":92},[1351],{"type":21,"value":430},{"type":16,"tag":85,"props":1353,"children":1354},{"class":87,"line":243},[1355,1360,1364,1369],{"type":16,"tag":85,"props":1356,"children":1357},{"style":92},[1358],{"type":21,"value":1359},"            dir_down ",{"type":16,"tag":85,"props":1361,"children":1362},{"style":98},[1363],{"type":21,"value":568},{"type":16,"tag":85,"props":1365,"children":1366},{"style":98},[1367],{"type":21,"value":1368}," not",{"type":16,"tag":85,"props":1370,"children":1371},{"style":92},[1372],{"type":21,"value":1373}," dir_down\n",{"type":16,"tag":85,"props":1375,"children":1376},{"class":87,"line":252},[1377],{"type":16,"tag":85,"props":1378,"children":1379},{"emptyLinePlaceholder":338},[1380],{"type":21,"value":341},{"type":16,"tag":85,"props":1382,"children":1383},{"class":87,"line":261},[1384,1389,1393],{"type":16,"tag":85,"props":1385,"children":1386},{"style":92},[1387],{"type":21,"value":1388},"        rail[row][col] ",{"type":16,"tag":85,"props":1390,"children":1391},{"style":98},[1392],{"type":21,"value":568},{"type":16,"tag":85,"props":1394,"children":1395},{"style":92},[1396],{"type":21,"value":1397}," text[i]\n",{"type":16,"tag":85,"props":1399,"children":1400},{"class":87,"line":280},[1401,1406,1410],{"type":16,"tag":85,"props":1402,"children":1403},{"style":92},[1404],{"type":21,"value":1405},"        col ",{"type":16,"tag":85,"props":1407,"children":1408},{"style":98},[1409],{"type":21,"value":487},{"type":16,"tag":85,"props":1411,"children":1412},{"style":118},[1413],{"type":21,"value":1414}," 1\n",{"type":16,"tag":85,"props":1416,"children":1417},{"class":87,"line":296},[1418,1422],{"type":16,"tag":85,"props":1419,"children":1420},{"style":98},[1421],{"type":21,"value":1300},{"type":16,"tag":85,"props":1423,"children":1424},{"style":92},[1425],{"type":21,"value":1426}," dir_down:\n",{"type":16,"tag":85,"props":1428,"children":1429},{"class":87,"line":801},[1430,1435,1439],{"type":16,"tag":85,"props":1431,"children":1432},{"style":92},[1433],{"type":21,"value":1434},"            row ",{"type":16,"tag":85,"props":1436,"children":1437},{"style":98},[1438],{"type":21,"value":487},{"type":16,"tag":85,"props":1440,"children":1441},{"style":118},[1442],{"type":21,"value":1414},{"type":16,"tag":85,"props":1444,"children":1445},{"class":87,"line":873},[1446,1451],{"type":16,"tag":85,"props":1447,"children":1448},{"style":98},[1449],{"type":21,"value":1450},"        else",{"type":16,"tag":85,"props":1452,"children":1453},{"style":92},[1454],{"type":21,"value":474},{"type":16,"tag":85,"props":1456,"children":1457},{"class":87,"line":890},[1458,1462,1467],{"type":16,"tag":85,"props":1459,"children":1460},{"style":92},[1461],{"type":21,"value":1434},{"type":16,"tag":85,"props":1463,"children":1464},{"style":98},[1465],{"type":21,"value":1466},"-=",{"type":16,"tag":85,"props":1468,"children":1469},{"style":118},[1470],{"type":21,"value":1414},{"type":16,"tag":85,"props":1472,"children":1473},{"class":87,"line":910},[1474,1479,1483],{"type":16,"tag":85,"props":1475,"children":1476},{"style":92},[1477],{"type":21,"value":1478},"    result ",{"type":16,"tag":85,"props":1480,"children":1481},{"style":98},[1482],{"type":21,"value":568},{"type":16,"tag":85,"props":1484,"children":1485},{"style":92},[1486],{"type":21,"value":653},{"type":16,"tag":85,"props":1488,"children":1489},{"class":87,"line":927},[1490,1494,1498,1502,1506],{"type":16,"tag":85,"props":1491,"children":1492},{"style":98},[1493],{"type":21,"value":661},{"type":16,"tag":85,"props":1495,"children":1496},{"style":92},[1497],{"type":21,"value":595},{"type":16,"tag":85,"props":1499,"children":1500},{"style":98},[1501],{"type":21,"value":600},{"type":16,"tag":85,"props":1503,"children":1504},{"style":441},[1505],{"type":21,"value":605},{"type":16,"tag":85,"props":1507,"children":1508},{"style":92},[1509],{"type":21,"value":1510},"(key):\n",{"type":16,"tag":85,"props":1512,"children":1513},{"class":87,"line":944},[1514,1519,1523,1527,1531,1535,1539],{"type":16,"tag":85,"props":1515,"children":1516},{"style":98},[1517],{"type":21,"value":1518},"        for",{"type":16,"tag":85,"props":1520,"children":1521},{"style":92},[1522],{"type":21,"value":1198},{"type":16,"tag":85,"props":1524,"children":1525},{"style":98},[1526],{"type":21,"value":600},{"type":16,"tag":85,"props":1528,"children":1529},{"style":441},[1530],{"type":21,"value":605},{"type":16,"tag":85,"props":1532,"children":1533},{"style":92},[1534],{"type":21,"value":400},{"type":16,"tag":85,"props":1536,"children":1537},{"style":441},[1538],{"type":21,"value":497},{"type":16,"tag":85,"props":1540,"children":1541},{"style":92},[1542],{"type":21,"value":1292},{"type":16,"tag":85,"props":1544,"children":1545},{"class":87,"line":953},[1546,1551,1556,1561,1566,1570,1574],{"type":16,"tag":85,"props":1547,"children":1548},{"style":98},[1549],{"type":21,"value":1550},"            if",{"type":16,"tag":85,"props":1552,"children":1553},{"style":92},[1554],{"type":21,"value":1555}," rail[i][j] ",{"type":16,"tag":85,"props":1557,"children":1558},{"style":98},[1559],{"type":21,"value":1560},"!=",{"type":16,"tag":85,"props":1562,"children":1563},{"style":743},[1564],{"type":21,"value":1565}," '",{"type":16,"tag":85,"props":1567,"children":1568},{"style":118},[1569],{"type":21,"value":1151},{"type":16,"tag":85,"props":1571,"children":1572},{"style":743},[1573],{"type":21,"value":1146},{"type":16,"tag":85,"props":1575,"children":1576},{"style":92},[1577],{"type":21,"value":474},{"type":16,"tag":85,"props":1579,"children":1580},{"class":87,"line":970},[1581],{"type":16,"tag":85,"props":1582,"children":1583},{"style":92},[1584],{"type":21,"value":1585},"                result.append(rail[i][j])\n",{"type":16,"tag":85,"props":1587,"children":1589},{"class":87,"line":1588},26,[1590,1594,1598,1603],{"type":16,"tag":85,"props":1591,"children":1592},{"style":98},[1593],{"type":21,"value":740},{"type":16,"tag":85,"props":1595,"children":1596},{"style":92},[1597],{"type":21,"value":400},{"type":16,"tag":85,"props":1599,"children":1600},{"style":743},[1601],{"type":21,"value":1602},"\"\"",{"type":16,"tag":85,"props":1604,"children":1605},{"style":92},[1606],{"type":21,"value":1607}," . join(result))\n",{"type":16,"tag":85,"props":1609,"children":1611},{"class":87,"line":1610},27,[1612],{"type":16,"tag":85,"props":1613,"children":1614},{"emptyLinePlaceholder":338},[1615],{"type":21,"value":341},{"type":16,"tag":85,"props":1617,"children":1619},{"class":87,"line":1618},28,[1620],{"type":16,"tag":85,"props":1621,"children":1622},{"emptyLinePlaceholder":338},[1623],{"type":21,"value":341},{"type":16,"tag":85,"props":1625,"children":1627},{"class":87,"line":1626},29,[1628,1632,1637,1641,1646,1650,1654],{"type":16,"tag":85,"props":1629,"children":1630},{"style":387},[1631],{"type":21,"value":390},{"type":16,"tag":85,"props":1633,"children":1634},{"style":151},[1635],{"type":21,"value":1636}," decryptRailFence",{"type":16,"tag":85,"props":1638,"children":1639},{"style":92},[1640],{"type":21,"value":400},{"type":16,"tag":85,"props":1642,"children":1643},{"style":403},[1644],{"type":21,"value":1645},"cipher",{"type":16,"tag":85,"props":1647,"children":1648},{"style":92},[1649],{"type":21,"value":1116},{"type":16,"tag":85,"props":1651,"children":1652},{"style":403},[1653],{"type":21,"value":416},{"type":16,"tag":85,"props":1655,"children":1656},{"style":92},[1657],{"type":21,"value":430},{"type":16,"tag":85,"props":1659,"children":1661},{"class":87,"line":1660},30,[1662,1666,1670,1674,1678,1682,1686,1690,1694,1698,1702,1706,1710],{"type":16,"tag":85,"props":1663,"children":1664},{"style":92},[1665],{"type":21,"value":1132},{"type":16,"tag":85,"props":1667,"children":1668},{"style":98},[1669],{"type":21,"value":568},{"type":16,"tag":85,"props":1671,"children":1672},{"style":92},[1673],{"type":21,"value":1141},{"type":16,"tag":85,"props":1675,"children":1676},{"style":743},[1677],{"type":21,"value":1146},{"type":16,"tag":85,"props":1679,"children":1680},{"style":118},[1681],{"type":21,"value":1151},{"type":16,"tag":85,"props":1683,"children":1684},{"style":743},[1685],{"type":21,"value":1146},{"type":16,"tag":85,"props":1687,"children":1688},{"style":98},[1689],{"type":21,"value":1160},{"type":16,"tag":85,"props":1691,"children":1692},{"style":92},[1693],{"type":21,"value":595},{"type":16,"tag":85,"props":1695,"children":1696},{"style":98},[1697],{"type":21,"value":600},{"type":16,"tag":85,"props":1699,"children":1700},{"style":441},[1701],{"type":21,"value":605},{"type":16,"tag":85,"props":1703,"children":1704},{"style":92},[1705],{"type":21,"value":400},{"type":16,"tag":85,"props":1707,"children":1708},{"style":441},[1709],{"type":21,"value":497},{"type":16,"tag":85,"props":1711,"children":1712},{"style":92},[1713],{"type":21,"value":1714},"(cipher))]\n",{"type":16,"tag":85,"props":1716,"children":1718},{"class":87,"line":1717},31,[1719,1723,1727,1731,1735],{"type":16,"tag":85,"props":1720,"children":1721},{"style":98},[1722],{"type":21,"value":1193},{"type":16,"tag":85,"props":1724,"children":1725},{"style":92},[1726],{"type":21,"value":1198},{"type":16,"tag":85,"props":1728,"children":1729},{"style":98},[1730],{"type":21,"value":600},{"type":16,"tag":85,"props":1732,"children":1733},{"style":441},[1734],{"type":21,"value":605},{"type":16,"tag":85,"props":1736,"children":1737},{"style":92},[1738],{"type":21,"value":1211},{"type":16,"tag":85,"props":1740,"children":1742},{"class":87,"line":1741},32,[1743,1747,1751],{"type":16,"tag":85,"props":1744,"children":1745},{"style":92},[1746],{"type":21,"value":1219},{"type":16,"tag":85,"props":1748,"children":1749},{"style":98},[1750],{"type":21,"value":568},{"type":16,"tag":85,"props":1752,"children":1753},{"style":118},[1754],{"type":21,"value":1755}," None\n",{"type":16,"tag":85,"props":1757,"children":1759},{"class":87,"line":1758},33,[1760,1764,1768,1772,1776],{"type":16,"tag":85,"props":1761,"children":1762},{"style":92},[1763],{"type":21,"value":1236},{"type":16,"tag":85,"props":1765,"children":1766},{"style":98},[1767],{"type":21,"value":568},{"type":16,"tag":85,"props":1769,"children":1770},{"style":118},[1771],{"type":21,"value":469},{"type":16,"tag":85,"props":1773,"children":1774},{"style":92},[1775],{"type":21,"value":1116},{"type":16,"tag":85,"props":1777,"children":1778},{"style":118},[1779],{"type":21,"value":1253},{"type":16,"tag":85,"props":1781,"children":1783},{"class":87,"line":1782},34,[1784],{"type":16,"tag":85,"props":1785,"children":1786},{"emptyLinePlaceholder":338},[1787],{"type":21,"value":341},{"type":16,"tag":85,"props":1789,"children":1791},{"class":87,"line":1790},35,[1792,1796,1800,1804,1808,1812,1816],{"type":16,"tag":85,"props":1793,"children":1794},{"style":98},[1795],{"type":21,"value":661},{"type":16,"tag":85,"props":1797,"children":1798},{"style":92},[1799],{"type":21,"value":595},{"type":16,"tag":85,"props":1801,"children":1802},{"style":98},[1803],{"type":21,"value":600},{"type":16,"tag":85,"props":1805,"children":1806},{"style":441},[1807],{"type":21,"value":605},{"type":16,"tag":85,"props":1809,"children":1810},{"style":92},[1811],{"type":21,"value":400},{"type":16,"tag":85,"props":1813,"children":1814},{"style":441},[1815],{"type":21,"value":497},{"type":16,"tag":85,"props":1817,"children":1818},{"style":92},[1819],{"type":21,"value":1820},"(cipher)):\n",{"type":16,"tag":85,"props":1822,"children":1824},{"class":87,"line":1823},36,[1825,1829,1834,1838,1842],{"type":16,"tag":85,"props":1826,"children":1827},{"style":98},[1828],{"type":21,"value":1300},{"type":16,"tag":85,"props":1830,"children":1831},{"style":92},[1832],{"type":21,"value":1833}," row ",{"type":16,"tag":85,"props":1835,"children":1836},{"style":98},[1837],{"type":21,"value":1310},{"type":16,"tag":85,"props":1839,"children":1840},{"style":118},[1841],{"type":21,"value":469},{"type":16,"tag":85,"props":1843,"children":1844},{"style":92},[1845],{"type":21,"value":474},{"type":16,"tag":85,"props":1847,"children":1849},{"class":87,"line":1848},37,[1850,1854,1858],{"type":16,"tag":85,"props":1851,"children":1852},{"style":92},[1853],{"type":21,"value":1359},{"type":16,"tag":85,"props":1855,"children":1856},{"style":98},[1857],{"type":21,"value":568},{"type":16,"tag":85,"props":1859,"children":1860},{"style":118},[1861],{"type":21,"value":1862}," True\n",{"type":16,"tag":85,"props":1864,"children":1866},{"class":87,"line":1865},38,[1867,1871,1875,1879,1883,1887,1891],{"type":16,"tag":85,"props":1868,"children":1869},{"style":98},[1870],{"type":21,"value":1300},{"type":16,"tag":85,"props":1872,"children":1873},{"style":92},[1874],{"type":21,"value":1833},{"type":16,"tag":85,"props":1876,"children":1877},{"style":98},[1878],{"type":21,"value":1310},{"type":16,"tag":85,"props":1880,"children":1881},{"style":92},[1882],{"type":21,"value":1337},{"type":16,"tag":85,"props":1884,"children":1885},{"style":98},[1886],{"type":21,"value":1342},{"type":16,"tag":85,"props":1888,"children":1889},{"style":118},[1890],{"type":21,"value":1347},{"type":16,"tag":85,"props":1892,"children":1893},{"style":92},[1894],{"type":21,"value":474},{"type":16,"tag":85,"props":1896,"children":1898},{"class":87,"line":1897},39,[1899,1903,1907],{"type":16,"tag":85,"props":1900,"children":1901},{"style":92},[1902],{"type":21,"value":1359},{"type":16,"tag":85,"props":1904,"children":1905},{"style":98},[1906],{"type":21,"value":568},{"type":16,"tag":85,"props":1908,"children":1909},{"style":118},[1910],{"type":21,"value":1228},{"type":16,"tag":85,"props":1912,"children":1914},{"class":87,"line":1913},40,[1915],{"type":16,"tag":85,"props":1916,"children":1917},{"emptyLinePlaceholder":338},[1918],{"type":21,"value":341},{"type":16,"tag":85,"props":1920,"children":1922},{"class":87,"line":1921},41,[1923,1927,1931],{"type":16,"tag":85,"props":1924,"children":1925},{"style":92},[1926],{"type":21,"value":1388},{"type":16,"tag":85,"props":1928,"children":1929},{"style":98},[1930],{"type":21,"value":568},{"type":16,"tag":85,"props":1932,"children":1933},{"style":743},[1934],{"type":21,"value":1935}," '*'\n",{"type":16,"tag":85,"props":1937,"children":1939},{"class":87,"line":1938},42,[1940,1944,1948],{"type":16,"tag":85,"props":1941,"children":1942},{"style":92},[1943],{"type":21,"value":1405},{"type":16,"tag":85,"props":1945,"children":1946},{"style":98},[1947],{"type":21,"value":487},{"type":16,"tag":85,"props":1949,"children":1950},{"style":118},[1951],{"type":21,"value":1414},{"type":16,"tag":85,"props":1953,"children":1955},{"class":87,"line":1954},43,[1956],{"type":16,"tag":85,"props":1957,"children":1958},{"emptyLinePlaceholder":338},[1959],{"type":21,"value":341},{"type":16,"tag":85,"props":1961,"children":1963},{"class":87,"line":1962},44,[1964,1968],{"type":16,"tag":85,"props":1965,"children":1966},{"style":98},[1967],{"type":21,"value":1300},{"type":16,"tag":85,"props":1969,"children":1970},{"style":92},[1971],{"type":21,"value":1426},{"type":16,"tag":85,"props":1973,"children":1975},{"class":87,"line":1974},45,[1976,1980,1984],{"type":16,"tag":85,"props":1977,"children":1978},{"style":92},[1979],{"type":21,"value":1434},{"type":16,"tag":85,"props":1981,"children":1982},{"style":98},[1983],{"type":21,"value":487},{"type":16,"tag":85,"props":1985,"children":1986},{"style":118},[1987],{"type":21,"value":1414},{"type":16,"tag":85,"props":1989,"children":1991},{"class":87,"line":1990},46,[1992,1996],{"type":16,"tag":85,"props":1993,"children":1994},{"style":98},[1995],{"type":21,"value":1450},{"type":16,"tag":85,"props":1997,"children":1998},{"style":92},[1999],{"type":21,"value":474},{"type":16,"tag":85,"props":2001,"children":2003},{"class":87,"line":2002},47,[2004,2008,2012],{"type":16,"tag":85,"props":2005,"children":2006},{"style":92},[2007],{"type":21,"value":1434},{"type":16,"tag":85,"props":2009,"children":2010},{"style":98},[2011],{"type":21,"value":1466},{"type":16,"tag":85,"props":2013,"children":2014},{"style":118},[2015],{"type":21,"value":1414},{"type":16,"tag":85,"props":2017,"children":2019},{"class":87,"line":2018},48,[2020,2025,2029],{"type":16,"tag":85,"props":2021,"children":2022},{"style":92},[2023],{"type":21,"value":2024},"    index ",{"type":16,"tag":85,"props":2026,"children":2027},{"style":98},[2028],{"type":21,"value":568},{"type":16,"tag":85,"props":2030,"children":2031},{"style":118},[2032],{"type":21,"value":2033}," 0\n",{"type":16,"tag":85,"props":2035,"children":2037},{"class":87,"line":2036},49,[2038,2042,2046,2050,2054],{"type":16,"tag":85,"props":2039,"children":2040},{"style":98},[2041],{"type":21,"value":661},{"type":16,"tag":85,"props":2043,"children":2044},{"style":92},[2045],{"type":21,"value":595},{"type":16,"tag":85,"props":2047,"children":2048},{"style":98},[2049],{"type":21,"value":600},{"type":16,"tag":85,"props":2051,"children":2052},{"style":441},[2053],{"type":21,"value":605},{"type":16,"tag":85,"props":2055,"children":2056},{"style":92},[2057],{"type":21,"value":1510},{"type":16,"tag":85,"props":2059,"children":2061},{"class":87,"line":2060},50,[2062,2066,2070,2074,2078,2082,2086],{"type":16,"tag":85,"props":2063,"children":2064},{"style":98},[2065],{"type":21,"value":1518},{"type":16,"tag":85,"props":2067,"children":2068},{"style":92},[2069],{"type":21,"value":1198},{"type":16,"tag":85,"props":2071,"children":2072},{"style":98},[2073],{"type":21,"value":600},{"type":16,"tag":85,"props":2075,"children":2076},{"style":441},[2077],{"type":21,"value":605},{"type":16,"tag":85,"props":2079,"children":2080},{"style":92},[2081],{"type":21,"value":400},{"type":16,"tag":85,"props":2083,"children":2084},{"style":441},[2085],{"type":21,"value":497},{"type":16,"tag":85,"props":2087,"children":2088},{"style":92},[2089],{"type":21,"value":1820},{"type":16,"tag":85,"props":2091,"children":2093},{"class":87,"line":2092},51,[2094,2098,2103,2107,2112,2116],{"type":16,"tag":85,"props":2095,"children":2096},{"style":98},[2097],{"type":21,"value":1550},{"type":16,"tag":85,"props":2099,"children":2100},{"style":92},[2101],{"type":21,"value":2102}," ((rail[i][j] ",{"type":16,"tag":85,"props":2104,"children":2105},{"style":98},[2106],{"type":21,"value":1310},{"type":16,"tag":85,"props":2108,"children":2109},{"style":743},[2110],{"type":21,"value":2111}," '*'",{"type":16,"tag":85,"props":2113,"children":2114},{"style":92},[2115],{"type":21,"value":1319},{"type":16,"tag":85,"props":2117,"children":2118},{"style":98},[2119],{"type":21,"value":2120},"and\n",{"type":16,"tag":85,"props":2122,"children":2124},{"class":87,"line":2123},52,[2125,2130,2135,2139],{"type":16,"tag":85,"props":2126,"children":2127},{"style":92},[2128],{"type":21,"value":2129},"               (index ",{"type":16,"tag":85,"props":2131,"children":2132},{"style":98},[2133],{"type":21,"value":2134},"\u003C",{"type":16,"tag":85,"props":2136,"children":2137},{"style":441},[2138],{"type":21,"value":444},{"type":16,"tag":85,"props":2140,"children":2141},{"style":92},[2142],{"type":21,"value":2143},"(cipher))):\n",{"type":16,"tag":85,"props":2145,"children":2147},{"class":87,"line":2146},53,[2148,2153,2157],{"type":16,"tag":85,"props":2149,"children":2150},{"style":92},[2151],{"type":21,"value":2152},"                rail[i][j] ",{"type":16,"tag":85,"props":2154,"children":2155},{"style":98},[2156],{"type":21,"value":568},{"type":16,"tag":85,"props":2158,"children":2159},{"style":92},[2160],{"type":21,"value":2161}," cipher[index]\n",{"type":16,"tag":85,"props":2163,"children":2165},{"class":87,"line":2164},54,[2166,2171,2175],{"type":16,"tag":85,"props":2167,"children":2168},{"style":92},[2169],{"type":21,"value":2170},"                index ",{"type":16,"tag":85,"props":2172,"children":2173},{"style":98},[2174],{"type":21,"value":487},{"type":16,"tag":85,"props":2176,"children":2177},{"style":118},[2178],{"type":21,"value":1414},{"type":16,"tag":85,"props":2180,"children":2182},{"class":87,"line":2181},55,[2183,2187,2191],{"type":16,"tag":85,"props":2184,"children":2185},{"style":92},[2186],{"type":21,"value":1478},{"type":16,"tag":85,"props":2188,"children":2189},{"style":98},[2190],{"type":21,"value":568},{"type":16,"tag":85,"props":2192,"children":2193},{"style":92},[2194],{"type":21,"value":653},{"type":16,"tag":85,"props":2196,"children":2198},{"class":87,"line":2197},56,[2199,2203,2207,2211,2215],{"type":16,"tag":85,"props":2200,"children":2201},{"style":92},[2202],{"type":21,"value":1236},{"type":16,"tag":85,"props":2204,"children":2205},{"style":98},[2206],{"type":21,"value":568},{"type":16,"tag":85,"props":2208,"children":2209},{"style":118},[2210],{"type":21,"value":469},{"type":16,"tag":85,"props":2212,"children":2213},{"style":92},[2214],{"type":21,"value":1116},{"type":16,"tag":85,"props":2216,"children":2217},{"style":118},[2218],{"type":21,"value":1253},{"type":16,"tag":85,"props":2220,"children":2222},{"class":87,"line":2221},57,[2223,2227,2231,2235,2239,2243,2247],{"type":16,"tag":85,"props":2224,"children":2225},{"style":98},[2226],{"type":21,"value":661},{"type":16,"tag":85,"props":2228,"children":2229},{"style":92},[2230],{"type":21,"value":595},{"type":16,"tag":85,"props":2232,"children":2233},{"style":98},[2234],{"type":21,"value":600},{"type":16,"tag":85,"props":2236,"children":2237},{"style":441},[2238],{"type":21,"value":605},{"type":16,"tag":85,"props":2240,"children":2241},{"style":92},[2242],{"type":21,"value":400},{"type":16,"tag":85,"props":2244,"children":2245},{"style":441},[2246],{"type":21,"value":497},{"type":16,"tag":85,"props":2248,"children":2249},{"style":92},[2250],{"type":21,"value":1820},{"type":16,"tag":85,"props":2252,"children":2254},{"class":87,"line":2253},58,[2255,2259,2263,2267,2271],{"type":16,"tag":85,"props":2256,"children":2257},{"style":98},[2258],{"type":21,"value":1300},{"type":16,"tag":85,"props":2260,"children":2261},{"style":92},[2262],{"type":21,"value":1833},{"type":16,"tag":85,"props":2264,"children":2265},{"style":98},[2266],{"type":21,"value":1310},{"type":16,"tag":85,"props":2268,"children":2269},{"style":118},[2270],{"type":21,"value":469},{"type":16,"tag":85,"props":2272,"children":2273},{"style":92},[2274],{"type":21,"value":474},{"type":16,"tag":85,"props":2276,"children":2278},{"class":87,"line":2277},59,[2279,2283,2287],{"type":16,"tag":85,"props":2280,"children":2281},{"style":92},[2282],{"type":21,"value":1359},{"type":16,"tag":85,"props":2284,"children":2285},{"style":98},[2286],{"type":21,"value":568},{"type":16,"tag":85,"props":2288,"children":2289},{"style":118},[2290],{"type":21,"value":1862},{"type":16,"tag":85,"props":2292,"children":2294},{"class":87,"line":2293},60,[2295,2299,2303,2307,2312,2316,2320],{"type":16,"tag":85,"props":2296,"children":2297},{"style":98},[2298],{"type":21,"value":1300},{"type":16,"tag":85,"props":2300,"children":2301},{"style":92},[2302],{"type":21,"value":1833},{"type":16,"tag":85,"props":2304,"children":2305},{"style":98},[2306],{"type":21,"value":1310},{"type":16,"tag":85,"props":2308,"children":2309},{"style":92},[2310],{"type":21,"value":2311}," key",{"type":16,"tag":85,"props":2313,"children":2314},{"style":98},[2315],{"type":21,"value":1342},{"type":16,"tag":85,"props":2317,"children":2318},{"style":118},[2319],{"type":21,"value":121},{"type":16,"tag":85,"props":2321,"children":2322},{"style":92},[2323],{"type":21,"value":474},{"type":16,"tag":85,"props":2325,"children":2327},{"class":87,"line":2326},61,[2328,2332,2336],{"type":16,"tag":85,"props":2329,"children":2330},{"style":92},[2331],{"type":21,"value":1359},{"type":16,"tag":85,"props":2333,"children":2334},{"style":98},[2335],{"type":21,"value":568},{"type":16,"tag":85,"props":2337,"children":2338},{"style":118},[2339],{"type":21,"value":1228},{"type":16,"tag":85,"props":2341,"children":2343},{"class":87,"line":2342},62,[2344,2348,2353,2357,2361],{"type":16,"tag":85,"props":2345,"children":2346},{"style":98},[2347],{"type":21,"value":1300},{"type":16,"tag":85,"props":2349,"children":2350},{"style":92},[2351],{"type":21,"value":2352}," (rail[row][col] ",{"type":16,"tag":85,"props":2354,"children":2355},{"style":98},[2356],{"type":21,"value":1560},{"type":16,"tag":85,"props":2358,"children":2359},{"style":743},[2360],{"type":21,"value":2111},{"type":16,"tag":85,"props":2362,"children":2363},{"style":92},[2364],{"type":21,"value":430},{"type":16,"tag":85,"props":2366,"children":2368},{"class":87,"line":2367},63,[2369],{"type":16,"tag":85,"props":2370,"children":2371},{"style":92},[2372],{"type":21,"value":2373},"            result.append(rail[row][col])\n",{"type":16,"tag":85,"props":2375,"children":2377},{"class":87,"line":2376},64,[2378,2383,2387],{"type":16,"tag":85,"props":2379,"children":2380},{"style":92},[2381],{"type":21,"value":2382},"            col ",{"type":16,"tag":85,"props":2384,"children":2385},{"style":98},[2386],{"type":21,"value":487},{"type":16,"tag":85,"props":2388,"children":2389},{"style":118},[2390],{"type":21,"value":1414},{"type":16,"tag":85,"props":2392,"children":2394},{"class":87,"line":2393},65,[2395,2399],{"type":16,"tag":85,"props":2396,"children":2397},{"style":98},[2398],{"type":21,"value":1300},{"type":16,"tag":85,"props":2400,"children":2401},{"style":92},[2402],{"type":21,"value":1426},{"type":16,"tag":85,"props":2404,"children":2406},{"class":87,"line":2405},66,[2407,2411,2415],{"type":16,"tag":85,"props":2408,"children":2409},{"style":92},[2410],{"type":21,"value":1434},{"type":16,"tag":85,"props":2412,"children":2413},{"style":98},[2414],{"type":21,"value":487},{"type":16,"tag":85,"props":2416,"children":2417},{"style":118},[2418],{"type":21,"value":1414},{"type":16,"tag":85,"props":2420,"children":2422},{"class":87,"line":2421},67,[2423,2427],{"type":16,"tag":85,"props":2424,"children":2425},{"style":98},[2426],{"type":21,"value":1450},{"type":16,"tag":85,"props":2428,"children":2429},{"style":92},[2430],{"type":21,"value":474},{"type":16,"tag":85,"props":2432,"children":2434},{"class":87,"line":2433},68,[2435,2439,2443],{"type":16,"tag":85,"props":2436,"children":2437},{"style":92},[2438],{"type":21,"value":1434},{"type":16,"tag":85,"props":2440,"children":2441},{"style":98},[2442],{"type":21,"value":1466},{"type":16,"tag":85,"props":2444,"children":2445},{"style":118},[2446],{"type":21,"value":1414},{"type":16,"tag":85,"props":2448,"children":2450},{"class":87,"line":2449},69,[2451,2455,2459,2463],{"type":16,"tag":85,"props":2452,"children":2453},{"style":98},[2454],{"type":21,"value":740},{"type":16,"tag":85,"props":2456,"children":2457},{"style":92},[2458],{"type":21,"value":400},{"type":16,"tag":85,"props":2460,"children":2461},{"style":743},[2462],{"type":21,"value":1602},{"type":16,"tag":85,"props":2464,"children":2465},{"style":92},[2466],{"type":21,"value":2467},".join(result))\n",{"type":16,"tag":85,"props":2469,"children":2471},{"class":87,"line":2470},70,[2472],{"type":16,"tag":85,"props":2473,"children":2474},{"emptyLinePlaceholder":338},[2475],{"type":21,"value":341},{"type":16,"tag":85,"props":2477,"children":2479},{"class":87,"line":2478},71,[2480],{"type":16,"tag":85,"props":2481,"children":2482},{"emptyLinePlaceholder":338},[2483],{"type":21,"value":341},{"type":16,"tag":85,"props":2485,"children":2487},{"class":87,"line":2486},72,[2488,2492,2497,2501,2506,2510,2514],{"type":16,"tag":85,"props":2489,"children":2490},{"style":387},[2491],{"type":21,"value":390},{"type":16,"tag":85,"props":2493,"children":2494},{"style":151},[2495],{"type":21,"value":2496}," decryptVig",{"type":16,"tag":85,"props":2498,"children":2499},{"style":92},[2500],{"type":21,"value":400},{"type":16,"tag":85,"props":2502,"children":2503},{"style":403},[2504],{"type":21,"value":2505},"ciphertext",{"type":16,"tag":85,"props":2507,"children":2508},{"style":92},[2509],{"type":21,"value":1116},{"type":16,"tag":85,"props":2511,"children":2512},{"style":403},[2513],{"type":21,"value":416},{"type":16,"tag":85,"props":2515,"children":2516},{"style":92},[2517],{"type":21,"value":430},{"type":16,"tag":85,"props":2519,"children":2521},{"class":87,"line":2520},73,[2522,2527,2531,2535],{"type":16,"tag":85,"props":2523,"children":2524},{"style":92},[2525],{"type":21,"value":2526},"    key_length ",{"type":16,"tag":85,"props":2528,"children":2529},{"style":98},[2530],{"type":21,"value":568},{"type":16,"tag":85,"props":2532,"children":2533},{"style":441},[2534],{"type":21,"value":444},{"type":16,"tag":85,"props":2536,"children":2537},{"style":92},[2538],{"type":21,"value":2539},"(key)\n",{"type":16,"tag":85,"props":2541,"children":2543},{"class":87,"line":2542},74,[2544,2549,2553,2558,2562,2567,2571],{"type":16,"tag":85,"props":2545,"children":2546},{"style":92},[2547],{"type":21,"value":2548},"    key_as_int ",{"type":16,"tag":85,"props":2550,"children":2551},{"style":98},[2552],{"type":21,"value":568},{"type":16,"tag":85,"props":2554,"children":2555},{"style":92},[2556],{"type":21,"value":2557}," [alpha.find(k) ",{"type":16,"tag":85,"props":2559,"children":2560},{"style":98},[2561],{"type":21,"value":272},{"type":16,"tag":85,"props":2563,"children":2564},{"style":92},[2565],{"type":21,"value":2566}," k ",{"type":16,"tag":85,"props":2568,"children":2569},{"style":98},[2570],{"type":21,"value":600},{"type":16,"tag":85,"props":2572,"children":2573},{"style":92},[2574],{"type":21,"value":2575}," key]\n",{"type":16,"tag":85,"props":2577,"children":2579},{"class":87,"line":2578},75,[2580,2585,2589,2594,2598,2603,2607],{"type":16,"tag":85,"props":2581,"children":2582},{"style":92},[2583],{"type":21,"value":2584},"    ciphertext_int ",{"type":16,"tag":85,"props":2586,"children":2587},{"style":98},[2588],{"type":21,"value":568},{"type":16,"tag":85,"props":2590,"children":2591},{"style":92},[2592],{"type":21,"value":2593}," [alpha.find(c) ",{"type":16,"tag":85,"props":2595,"children":2596},{"style":98},[2597],{"type":21,"value":272},{"type":16,"tag":85,"props":2599,"children":2600},{"style":92},[2601],{"type":21,"value":2602}," c ",{"type":16,"tag":85,"props":2604,"children":2605},{"style":98},[2606],{"type":21,"value":600},{"type":16,"tag":85,"props":2608,"children":2609},{"style":92},[2610],{"type":21,"value":2611}," ciphertext]\n",{"type":16,"tag":85,"props":2613,"children":2615},{"class":87,"line":2614},76,[2616,2621,2625],{"type":16,"tag":85,"props":2617,"children":2618},{"style":92},[2619],{"type":21,"value":2620},"    plaintext ",{"type":16,"tag":85,"props":2622,"children":2623},{"style":98},[2624],{"type":21,"value":568},{"type":16,"tag":85,"props":2626,"children":2627},{"style":743},[2628],{"type":21,"value":2629}," ''\n",{"type":16,"tag":85,"props":2631,"children":2633},{"class":87,"line":2632},77,[2634,2638,2642,2646,2650,2654,2658],{"type":16,"tag":85,"props":2635,"children":2636},{"style":98},[2637],{"type":21,"value":661},{"type":16,"tag":85,"props":2639,"children":2640},{"style":92},[2641],{"type":21,"value":595},{"type":16,"tag":85,"props":2643,"children":2644},{"style":98},[2645],{"type":21,"value":600},{"type":16,"tag":85,"props":2647,"children":2648},{"style":441},[2649],{"type":21,"value":605},{"type":16,"tag":85,"props":2651,"children":2652},{"style":92},[2653],{"type":21,"value":400},{"type":16,"tag":85,"props":2655,"children":2656},{"style":441},[2657],{"type":21,"value":497},{"type":16,"tag":85,"props":2659,"children":2660},{"style":92},[2661],{"type":21,"value":2662},"(ciphertext_int)):\n",{"type":16,"tag":85,"props":2664,"children":2666},{"class":87,"line":2665},78,[2667,2672,2676,2681,2685,2690,2694,2699,2703,2707],{"type":16,"tag":85,"props":2668,"children":2669},{"style":92},[2670],{"type":21,"value":2671},"        p ",{"type":16,"tag":85,"props":2673,"children":2674},{"style":98},[2675],{"type":21,"value":568},{"type":16,"tag":85,"props":2677,"children":2678},{"style":92},[2679],{"type":21,"value":2680}," (ciphertext_int[i] ",{"type":16,"tag":85,"props":2682,"children":2683},{"style":98},[2684],{"type":21,"value":1342},{"type":16,"tag":85,"props":2686,"children":2687},{"style":92},[2688],{"type":21,"value":2689}," key_as_int[i ",{"type":16,"tag":85,"props":2691,"children":2692},{"style":98},[2693],{"type":21,"value":454},{"type":16,"tag":85,"props":2695,"children":2696},{"style":92},[2697],{"type":21,"value":2698}," key_length]) ",{"type":16,"tag":85,"props":2700,"children":2701},{"style":98},[2702],{"type":21,"value":454},{"type":16,"tag":85,"props":2704,"children":2705},{"style":441},[2706],{"type":21,"value":444},{"type":16,"tag":85,"props":2708,"children":2709},{"style":92},[2710],{"type":21,"value":2711},"(alpha)\n",{"type":16,"tag":85,"props":2713,"children":2715},{"class":87,"line":2714},79,[2716,2721,2725],{"type":16,"tag":85,"props":2717,"children":2718},{"style":92},[2719],{"type":21,"value":2720},"        plaintext ",{"type":16,"tag":85,"props":2722,"children":2723},{"style":98},[2724],{"type":21,"value":487},{"type":16,"tag":85,"props":2726,"children":2727},{"style":92},[2728],{"type":21,"value":2729}," alpha[p]\n",{"type":16,"tag":85,"props":2731,"children":2733},{"class":87,"line":2732},80,[2734,2738],{"type":16,"tag":85,"props":2735,"children":2736},{"style":98},[2737],{"type":21,"value":740},{"type":16,"tag":85,"props":2739,"children":2740},{"style":92},[2741],{"type":21,"value":2742}," plaintext\n",{"type":16,"tag":85,"props":2744,"children":2746},{"class":87,"line":2745},81,[2747],{"type":16,"tag":85,"props":2748,"children":2749},{"emptyLinePlaceholder":338},[2750],{"type":21,"value":341},{"type":16,"tag":85,"props":2752,"children":2754},{"class":87,"line":2753},82,[2755],{"type":16,"tag":85,"props":2756,"children":2757},{"emptyLinePlaceholder":338},[2758],{"type":21,"value":341},{"type":16,"tag":85,"props":2760,"children":2762},{"class":87,"line":2761},83,[2763,2767,2772,2776,2781,2785,2789],{"type":16,"tag":85,"props":2764,"children":2765},{"style":387},[2766],{"type":21,"value":390},{"type":16,"tag":85,"props":2768,"children":2769},{"style":151},[2770],{"type":21,"value":2771}," encryptVig",{"type":16,"tag":85,"props":2773,"children":2774},{"style":92},[2775],{"type":21,"value":400},{"type":16,"tag":85,"props":2777,"children":2778},{"style":403},[2779],{"type":21,"value":2780},"plaintext",{"type":16,"tag":85,"props":2782,"children":2783},{"style":92},[2784],{"type":21,"value":1116},{"type":16,"tag":85,"props":2786,"children":2787},{"style":403},[2788],{"type":21,"value":416},{"type":16,"tag":85,"props":2790,"children":2791},{"style":92},[2792],{"type":21,"value":430},{"type":16,"tag":85,"props":2794,"children":2796},{"class":87,"line":2795},84,[2797,2801,2805,2809],{"type":16,"tag":85,"props":2798,"children":2799},{"style":92},[2800],{"type":21,"value":2526},{"type":16,"tag":85,"props":2802,"children":2803},{"style":98},[2804],{"type":21,"value":568},{"type":16,"tag":85,"props":2806,"children":2807},{"style":441},[2808],{"type":21,"value":444},{"type":16,"tag":85,"props":2810,"children":2811},{"style":92},[2812],{"type":21,"value":2539},{"type":16,"tag":85,"props":2814,"children":2816},{"class":87,"line":2815},85,[2817,2821,2825,2829,2833,2837,2841],{"type":16,"tag":85,"props":2818,"children":2819},{"style":92},[2820],{"type":21,"value":2548},{"type":16,"tag":85,"props":2822,"children":2823},{"style":98},[2824],{"type":21,"value":568},{"type":16,"tag":85,"props":2826,"children":2827},{"style":92},[2828],{"type":21,"value":2557},{"type":16,"tag":85,"props":2830,"children":2831},{"style":98},[2832],{"type":21,"value":272},{"type":16,"tag":85,"props":2834,"children":2835},{"style":92},[2836],{"type":21,"value":2566},{"type":16,"tag":85,"props":2838,"children":2839},{"style":98},[2840],{"type":21,"value":600},{"type":16,"tag":85,"props":2842,"children":2843},{"style":92},[2844],{"type":21,"value":2575},{"type":16,"tag":85,"props":2846,"children":2848},{"class":87,"line":2847},86,[2849,2854,2858,2863,2867,2872,2876],{"type":16,"tag":85,"props":2850,"children":2851},{"style":92},[2852],{"type":21,"value":2853},"    plaintext_int ",{"type":16,"tag":85,"props":2855,"children":2856},{"style":98},[2857],{"type":21,"value":568},{"type":16,"tag":85,"props":2859,"children":2860},{"style":92},[2861],{"type":21,"value":2862}," [alpha.find(p) ",{"type":16,"tag":85,"props":2864,"children":2865},{"style":98},[2866],{"type":21,"value":272},{"type":16,"tag":85,"props":2868,"children":2869},{"style":92},[2870],{"type":21,"value":2871}," p ",{"type":16,"tag":85,"props":2873,"children":2874},{"style":98},[2875],{"type":21,"value":600},{"type":16,"tag":85,"props":2877,"children":2878},{"style":92},[2879],{"type":21,"value":2880}," plaintext]\n",{"type":16,"tag":85,"props":2882,"children":2884},{"class":87,"line":2883},87,[2885,2890,2894],{"type":16,"tag":85,"props":2886,"children":2887},{"style":92},[2888],{"type":21,"value":2889},"    ciphertext ",{"type":16,"tag":85,"props":2891,"children":2892},{"style":98},[2893],{"type":21,"value":568},{"type":16,"tag":85,"props":2895,"children":2896},{"style":743},[2897],{"type":21,"value":2629},{"type":16,"tag":85,"props":2899,"children":2901},{"class":87,"line":2900},88,[2902,2906,2910,2914,2918,2922,2926],{"type":16,"tag":85,"props":2903,"children":2904},{"style":98},[2905],{"type":21,"value":661},{"type":16,"tag":85,"props":2907,"children":2908},{"style":92},[2909],{"type":21,"value":595},{"type":16,"tag":85,"props":2911,"children":2912},{"style":98},[2913],{"type":21,"value":600},{"type":16,"tag":85,"props":2915,"children":2916},{"style":441},[2917],{"type":21,"value":605},{"type":16,"tag":85,"props":2919,"children":2920},{"style":92},[2921],{"type":21,"value":400},{"type":16,"tag":85,"props":2923,"children":2924},{"style":441},[2925],{"type":21,"value":497},{"type":16,"tag":85,"props":2927,"children":2928},{"style":92},[2929],{"type":21,"value":2930},"(plaintext_int)):\n",{"type":16,"tag":85,"props":2932,"children":2934},{"class":87,"line":2933},89,[2935,2940,2944,2949,2953,2957,2961,2965,2969,2973],{"type":16,"tag":85,"props":2936,"children":2937},{"style":92},[2938],{"type":21,"value":2939},"        c ",{"type":16,"tag":85,"props":2941,"children":2942},{"style":98},[2943],{"type":21,"value":568},{"type":16,"tag":85,"props":2945,"children":2946},{"style":92},[2947],{"type":21,"value":2948}," (plaintext_int[i] ",{"type":16,"tag":85,"props":2950,"children":2951},{"style":98},[2952],{"type":21,"value":578},{"type":16,"tag":85,"props":2954,"children":2955},{"style":92},[2956],{"type":21,"value":2689},{"type":16,"tag":85,"props":2958,"children":2959},{"style":98},[2960],{"type":21,"value":454},{"type":16,"tag":85,"props":2962,"children":2963},{"style":92},[2964],{"type":21,"value":2698},{"type":16,"tag":85,"props":2966,"children":2967},{"style":98},[2968],{"type":21,"value":454},{"type":16,"tag":85,"props":2970,"children":2971},{"style":441},[2972],{"type":21,"value":444},{"type":16,"tag":85,"props":2974,"children":2975},{"style":92},[2976],{"type":21,"value":2711},{"type":16,"tag":85,"props":2978,"children":2980},{"class":87,"line":2979},90,[2981,2986,2990],{"type":16,"tag":85,"props":2982,"children":2983},{"style":92},[2984],{"type":21,"value":2985},"        ciphertext ",{"type":16,"tag":85,"props":2987,"children":2988},{"style":98},[2989],{"type":21,"value":487},{"type":16,"tag":85,"props":2991,"children":2992},{"style":92},[2993],{"type":21,"value":2994}," alpha[c]\n",{"type":16,"tag":85,"props":2996,"children":2998},{"class":87,"line":2997},91,[2999,3003],{"type":16,"tag":85,"props":3000,"children":3001},{"style":98},[3002],{"type":21,"value":740},{"type":16,"tag":85,"props":3004,"children":3005},{"style":92},[3006],{"type":21,"value":3007}," ciphertext\n",{"type":16,"tag":85,"props":3009,"children":3011},{"class":87,"line":3010},92,[3012],{"type":16,"tag":85,"props":3013,"children":3014},{"emptyLinePlaceholder":338},[3015],{"type":21,"value":341},{"type":16,"tag":85,"props":3017,"children":3019},{"class":87,"line":3018},93,[3020],{"type":16,"tag":85,"props":3021,"children":3022},{"emptyLinePlaceholder":338},[3023],{"type":21,"value":341},{"type":16,"tag":85,"props":3025,"children":3027},{"class":87,"line":3026},94,[3028,3032,3036,3040,3044,3048,3052,3056,3060],{"type":16,"tag":85,"props":3029,"children":3030},{"style":387},[3031],{"type":21,"value":390},{"type":16,"tag":85,"props":3033,"children":3034},{"style":151},[3035],{"type":21,"value":770},{"type":16,"tag":85,"props":3037,"children":3038},{"style":92},[3039],{"type":21,"value":400},{"type":16,"tag":85,"props":3041,"children":3042},{"style":403},[3043],{"type":21,"value":406},{"type":16,"tag":85,"props":3045,"children":3046},{"style":92},[3047],{"type":21,"value":411},{"type":16,"tag":85,"props":3049,"children":3050},{"style":403},[3051],{"type":21,"value":416},{"type":16,"tag":85,"props":3053,"children":3054},{"style":92},[3055],{"type":21,"value":411},{"type":16,"tag":85,"props":3057,"children":3058},{"style":403},[3059],{"type":21,"value":425},{"type":16,"tag":85,"props":3061,"children":3062},{"style":92},[3063],{"type":21,"value":430},{"type":16,"tag":85,"props":3065,"children":3067},{"class":87,"line":3066},95,[3068,3072,3076,3080,3084,3088,3092,3096,3100,3104,3108,3112,3116,3120,3124,3128,3132],{"type":16,"tag":85,"props":3069,"children":3070},{"style":92},[3071],{"type":21,"value":563},{"type":16,"tag":85,"props":3073,"children":3074},{"style":98},[3075],{"type":21,"value":568},{"type":16,"tag":85,"props":3077,"children":3078},{"style":92},[3079],{"type":21,"value":573},{"type":16,"tag":85,"props":3081,"children":3082},{"style":98},[3083],{"type":21,"value":578},{"type":16,"tag":85,"props":3085,"children":3086},{"style":118},[3087],{"type":21,"value":529},{"type":16,"tag":85,"props":3089,"children":3090},{"style":92},[3091],{"type":21,"value":514},{"type":16,"tag":85,"props":3093,"children":3094},{"style":98},[3095],{"type":21,"value":272},{"type":16,"tag":85,"props":3097,"children":3098},{"style":92},[3099],{"type":21,"value":595},{"type":16,"tag":85,"props":3101,"children":3102},{"style":98},[3103],{"type":21,"value":600},{"type":16,"tag":85,"props":3105,"children":3106},{"style":441},[3107],{"type":21,"value":605},{"type":16,"tag":85,"props":3109,"children":3110},{"style":92},[3111],{"type":21,"value":400},{"type":16,"tag":85,"props":3113,"children":3114},{"style":118},[3115],{"type":21,"value":614},{"type":16,"tag":85,"props":3117,"children":3118},{"style":92},[3119],{"type":21,"value":411},{"type":16,"tag":85,"props":3121,"children":3122},{"style":441},[3123],{"type":21,"value":497},{"type":16,"tag":85,"props":3125,"children":3126},{"style":92},[3127],{"type":21,"value":627},{"type":16,"tag":85,"props":3129,"children":3130},{"style":118},[3131],{"type":21,"value":529},{"type":16,"tag":85,"props":3133,"children":3134},{"style":92},[3135],{"type":21,"value":636},{"type":16,"tag":85,"props":3137,"children":3139},{"class":87,"line":3138},96,[3140,3144,3148],{"type":16,"tag":85,"props":3141,"children":3142},{"style":92},[3143],{"type":21,"value":879},{"type":16,"tag":85,"props":3145,"children":3146},{"style":98},[3147],{"type":21,"value":568},{"type":16,"tag":85,"props":3149,"children":3150},{"style":92},[3151],{"type":21,"value":653},{"type":16,"tag":85,"props":3153,"children":3155},{"class":87,"line":3154},97,[3156,3160,3164,3168],{"type":16,"tag":85,"props":3157,"children":3158},{"style":98},[3159],{"type":21,"value":661},{"type":16,"tag":85,"props":3161,"children":3162},{"style":92},[3163],{"type":21,"value":595},{"type":16,"tag":85,"props":3165,"children":3166},{"style":98},[3167],{"type":21,"value":600},{"type":16,"tag":85,"props":3169,"children":3170},{"style":92},[3171],{"type":21,"value":674},{"type":16,"tag":85,"props":3173,"children":3175},{"class":87,"line":3174},98,[3176,3180,3184],{"type":16,"tag":85,"props":3177,"children":3178},{"style":92},[3179],{"type":21,"value":682},{"type":16,"tag":85,"props":3181,"children":3182},{"style":98},[3183],{"type":21,"value":568},{"type":16,"tag":85,"props":3185,"children":3186},{"style":92},[3187],{"type":21,"value":3188}," decryptRailFence(i,key)\n",{"type":16,"tag":85,"props":3190,"children":3192},{"class":87,"line":3191},99,[3193,3197,3201],{"type":16,"tag":85,"props":3194,"children":3195},{"style":92},[3196],{"type":21,"value":682},{"type":16,"tag":85,"props":3198,"children":3199},{"style":98},[3200],{"type":21,"value":568},{"type":16,"tag":85,"props":3202,"children":3203},{"style":92},[3204],{"type":21,"value":3205}," decryptVig(tmp,iv)\n",{"type":16,"tag":85,"props":3207,"children":3209},{"class":87,"line":3208},100,[3210],{"type":16,"tag":85,"props":3211,"children":3212},{"style":92},[3213],{"type":21,"value":950},{"type":16,"tag":85,"props":3215,"children":3217},{"class":87,"line":3216},101,[3218,3222,3226],{"type":16,"tag":85,"props":3219,"children":3220},{"style":92},[3221],{"type":21,"value":723},{"type":16,"tag":85,"props":3223,"children":3224},{"style":98},[3225],{"type":21,"value":568},{"type":16,"tag":85,"props":3227,"children":3228},{"style":92},[3229],{"type":21,"value":967},{"type":16,"tag":85,"props":3231,"children":3233},{"class":87,"line":3232},102,[3234,3238,3242],{"type":16,"tag":85,"props":3235,"children":3236},{"style":98},[3237],{"type":21,"value":740},{"type":16,"tag":85,"props":3239,"children":3240},{"style":743},[3241],{"type":21,"value":746},{"type":16,"tag":85,"props":3243,"children":3244},{"style":92},[3245],{"type":21,"value":984},{"type":16,"tag":85,"props":3247,"children":3249},{"class":87,"line":3248},103,[3250],{"type":16,"tag":85,"props":3251,"children":3252},{"emptyLinePlaceholder":338},[3253],{"type":21,"value":341},{"type":16,"tag":85,"props":3255,"children":3257},{"class":87,"line":3256},104,[3258],{"type":16,"tag":85,"props":3259,"children":3260},{"emptyLinePlaceholder":338},[3261],{"type":21,"value":341},{"type":16,"tag":85,"props":3263,"children":3265},{"class":87,"line":3264},105,[3266,3271,3276,3280,3285],{"type":16,"tag":85,"props":3267,"children":3268},{"style":98},[3269],{"type":21,"value":3270},"if",{"type":16,"tag":85,"props":3272,"children":3273},{"style":92},[3274],{"type":21,"value":3275}," __name__ ",{"type":16,"tag":85,"props":3277,"children":3278},{"style":98},[3279],{"type":21,"value":1310},{"type":16,"tag":85,"props":3281,"children":3282},{"style":743},[3283],{"type":21,"value":3284}," '__main__'",{"type":16,"tag":85,"props":3286,"children":3287},{"style":92},[3288],{"type":21,"value":474},{"type":16,"tag":85,"props":3290,"children":3292},{"class":87,"line":3291},106,[3293],{"type":16,"tag":85,"props":3294,"children":3295},{"style":329},[3296],{"type":21,"value":3297},"    # name: 'aaaaaa'\n",{"type":16,"tag":85,"props":3299,"children":3301},{"class":87,"line":3300},107,[3302],{"type":16,"tag":85,"props":3303,"children":3304},{"style":329},[3305],{"type":21,"value":3306},"    # password: ''\n",{"type":16,"tag":85,"props":3308,"children":3310},{"class":87,"line":3309},108,[3311,3316,3320,3325,3330],{"type":16,"tag":85,"props":3312,"children":3313},{"style":92},[3314],{"type":21,"value":3315},"    expected_chars ",{"type":16,"tag":85,"props":3317,"children":3318},{"style":98},[3319],{"type":21,"value":568},{"type":16,"tag":85,"props":3321,"children":3322},{"style":743},[3323],{"type":21,"value":3324}," '1'",{"type":16,"tag":85,"props":3326,"children":3327},{"style":98},[3328],{"type":21,"value":3329}," *",{"type":16,"tag":85,"props":3331,"children":3332},{"style":118},[3333],{"type":21,"value":3334}," 10\n",{"type":16,"tag":85,"props":3336,"children":3338},{"class":87,"line":3337},109,[3339,3344,3348],{"type":16,"tag":85,"props":3340,"children":3341},{"style":92},[3342],{"type":21,"value":3343},"    cookie ",{"type":16,"tag":85,"props":3345,"children":3346},{"style":98},[3347],{"type":21,"value":568},{"type":16,"tag":85,"props":3349,"children":3350},{"style":743},[3351],{"type":21,"value":3352}," \"2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d7a73530c0b66227736200b4174540c30\"\n",{"type":16,"tag":85,"props":3354,"children":3356},{"class":87,"line":3355},110,[3357,3362,3366],{"type":16,"tag":85,"props":3358,"children":3359},{"style":92},[3360],{"type":21,"value":3361},"    cipher ",{"type":16,"tag":85,"props":3363,"children":3364},{"style":98},[3365],{"type":21,"value":568},{"type":16,"tag":85,"props":3367,"children":3368},{"style":92},[3369],{"type":21,"value":3370}," unhexlify(cookie).decode()\n",{"type":16,"tag":85,"props":3372,"children":3374},{"class":87,"line":3373},111,[3375,3380,3384,3389,3393,3397,3401,3405,3409,3413,3417,3421,3425,3429,3433,3438,3442],{"type":16,"tag":85,"props":3376,"children":3377},{"style":92},[3378],{"type":21,"value":3379},"    ciphers ",{"type":16,"tag":85,"props":3381,"children":3382},{"style":98},[3383],{"type":21,"value":568},{"type":16,"tag":85,"props":3385,"children":3386},{"style":92},[3387],{"type":21,"value":3388}," [cipher[i:i",{"type":16,"tag":85,"props":3390,"children":3391},{"style":98},[3392],{"type":21,"value":578},{"type":16,"tag":85,"props":3394,"children":3395},{"style":118},[3396],{"type":21,"value":529},{"type":16,"tag":85,"props":3398,"children":3399},{"style":92},[3400],{"type":21,"value":514},{"type":16,"tag":85,"props":3402,"children":3403},{"style":98},[3404],{"type":21,"value":272},{"type":16,"tag":85,"props":3406,"children":3407},{"style":92},[3408],{"type":21,"value":595},{"type":16,"tag":85,"props":3410,"children":3411},{"style":98},[3412],{"type":21,"value":600},{"type":16,"tag":85,"props":3414,"children":3415},{"style":441},[3416],{"type":21,"value":605},{"type":16,"tag":85,"props":3418,"children":3419},{"style":92},[3420],{"type":21,"value":400},{"type":16,"tag":85,"props":3422,"children":3423},{"style":118},[3424],{"type":21,"value":614},{"type":16,"tag":85,"props":3426,"children":3427},{"style":92},[3428],{"type":21,"value":1116},{"type":16,"tag":85,"props":3430,"children":3431},{"style":441},[3432],{"type":21,"value":497},{"type":16,"tag":85,"props":3434,"children":3435},{"style":92},[3436],{"type":21,"value":3437},"(cipher), ",{"type":16,"tag":85,"props":3439,"children":3440},{"style":118},[3441],{"type":21,"value":529},{"type":16,"tag":85,"props":3443,"children":3444},{"style":92},[3445],{"type":21,"value":636},{"type":16,"tag":85,"props":3447,"children":3449},{"class":87,"line":3448},112,[3450,3455,3459,3464,3468,3472],{"type":16,"tag":85,"props":3451,"children":3452},{"style":92},[3453],{"type":21,"value":3454},"    last_cipher ",{"type":16,"tag":85,"props":3456,"children":3457},{"style":98},[3458],{"type":21,"value":568},{"type":16,"tag":85,"props":3460,"children":3461},{"style":92},[3462],{"type":21,"value":3463}," ciphers[",{"type":16,"tag":85,"props":3465,"children":3466},{"style":98},[3467],{"type":21,"value":1342},{"type":16,"tag":85,"props":3469,"children":3470},{"style":118},[3471],{"type":21,"value":121},{"type":16,"tag":85,"props":3473,"children":3474},{"style":92},[3475],{"type":21,"value":3476},"]\n",{"type":16,"tag":85,"props":3478,"children":3480},{"class":87,"line":3479},113,[3481,3486,3490,3494],{"type":16,"tag":85,"props":3482,"children":3483},{"style":92},[3484],{"type":21,"value":3485},"    rf_key ",{"type":16,"tag":85,"props":3487,"children":3488},{"style":98},[3489],{"type":21,"value":568},{"type":16,"tag":85,"props":3491,"children":3492},{"style":98},[3493],{"type":21,"value":534},{"type":16,"tag":85,"props":3495,"children":3496},{"style":118},[3497],{"type":21,"value":154},{"type":16,"tag":85,"props":3499,"children":3501},{"class":87,"line":3500},114,[3502,3506,3510,3514,3518,3522,3526,3530,3534],{"type":16,"tag":85,"props":3503,"children":3504},{"style":98},[3505],{"type":21,"value":661},{"type":16,"tag":85,"props":3507,"children":3508},{"style":92},[3509],{"type":21,"value":595},{"type":16,"tag":85,"props":3511,"children":3512},{"style":98},[3513],{"type":21,"value":600},{"type":16,"tag":85,"props":3515,"children":3516},{"style":441},[3517],{"type":21,"value":605},{"type":16,"tag":85,"props":3519,"children":3520},{"style":92},[3521],{"type":21,"value":400},{"type":16,"tag":85,"props":3523,"children":3524},{"style":118},[3525],{"type":21,"value":139},{"type":16,"tag":85,"props":3527,"children":3528},{"style":92},[3529],{"type":21,"value":1116},{"type":16,"tag":85,"props":3531,"children":3532},{"style":118},[3533],{"type":21,"value":529},{"type":16,"tag":85,"props":3535,"children":3536},{"style":92},[3537],{"type":21,"value":430},{"type":16,"tag":85,"props":3539,"children":3541},{"class":87,"line":3540},115,[3542,3546,3550],{"type":16,"tag":85,"props":3543,"children":3544},{"style":92},[3545],{"type":21,"value":2671},{"type":16,"tag":85,"props":3547,"children":3548},{"style":98},[3549],{"type":21,"value":568},{"type":16,"tag":85,"props":3551,"children":3552},{"style":92},[3553],{"type":21,"value":3554}," decryptRailFence(last_cipher, i)\n",{"type":16,"tag":85,"props":3556,"children":3558},{"class":87,"line":3557},116,[3559,3563,3567,3572,3576,3580],{"type":16,"tag":85,"props":3560,"children":3561},{"style":92},[3562],{"type":21,"value":2671},{"type":16,"tag":85,"props":3564,"children":3565},{"style":98},[3566],{"type":21,"value":568},{"type":16,"tag":85,"props":3568,"children":3569},{"style":92},[3570],{"type":21,"value":3571}," decryptVig(p, ciphers[",{"type":16,"tag":85,"props":3573,"children":3574},{"style":98},[3575],{"type":21,"value":1342},{"type":16,"tag":85,"props":3577,"children":3578},{"style":118},[3579],{"type":21,"value":139},{"type":16,"tag":85,"props":3581,"children":3582},{"style":92},[3583],{"type":21,"value":3584},"])\n",{"type":16,"tag":85,"props":3586,"children":3588},{"class":87,"line":3587},117,[3589,3593,3598,3602],{"type":16,"tag":85,"props":3590,"children":3591},{"style":98},[3592],{"type":21,"value":1300},{"type":16,"tag":85,"props":3594,"children":3595},{"style":92},[3596],{"type":21,"value":3597}," expected_chars ",{"type":16,"tag":85,"props":3599,"children":3600},{"style":98},[3601],{"type":21,"value":600},{"type":16,"tag":85,"props":3603,"children":3604},{"style":92},[3605],{"type":21,"value":3606}," p:\n",{"type":16,"tag":85,"props":3608,"children":3610},{"class":87,"line":3609},118,[3611,3616,3620,3625,3630,3635,3640],{"type":16,"tag":85,"props":3612,"children":3613},{"style":441},[3614],{"type":21,"value":3615},"            print",{"type":16,"tag":85,"props":3617,"children":3618},{"style":92},[3619],{"type":21,"value":400},{"type":16,"tag":85,"props":3621,"children":3622},{"style":743},[3623],{"type":21,"value":3624},"\"Found RF key: ",{"type":16,"tag":85,"props":3626,"children":3627},{"style":118},[3628],{"type":21,"value":3629},"%d",{"type":16,"tag":85,"props":3631,"children":3632},{"style":743},[3633],{"type":21,"value":3634},"\"",{"type":16,"tag":85,"props":3636,"children":3637},{"style":98},[3638],{"type":21,"value":3639}," %",{"type":16,"tag":85,"props":3641,"children":3642},{"style":92},[3643],{"type":21,"value":3644}," i)\n",{"type":16,"tag":85,"props":3646,"children":3648},{"class":87,"line":3647},119,[3649,3654,3658],{"type":16,"tag":85,"props":3650,"children":3651},{"style":92},[3652],{"type":21,"value":3653},"            rf_key ",{"type":16,"tag":85,"props":3655,"children":3656},{"style":98},[3657],{"type":21,"value":568},{"type":16,"tag":85,"props":3659,"children":3660},{"style":92},[3661],{"type":21,"value":967},{"type":16,"tag":85,"props":3663,"children":3665},{"class":87,"line":3664},120,[3666,3671,3676,3681],{"type":16,"tag":85,"props":3667,"children":3668},{"style":441},[3669],{"type":21,"value":3670},"    print",{"type":16,"tag":85,"props":3672,"children":3673},{"style":92},[3674],{"type":21,"value":3675},"(decrypt(cipher, rf_key, ",{"type":16,"tag":85,"props":3677,"children":3678},{"style":743},[3679],{"type":21,"value":3680},"\"0\"",{"type":16,"tag":85,"props":3682,"children":3683},{"style":92},[3684],{"type":21,"value":3685},"))\n",{"type":16,"tag":85,"props":3687,"children":3689},{"class":87,"line":3688},121,[3690,3695,3699],{"type":16,"tag":85,"props":3691,"children":3692},{"style":92},[3693],{"type":21,"value":3694},"    admin_val ",{"type":16,"tag":85,"props":3696,"children":3697},{"style":98},[3698],{"type":21,"value":568},{"type":16,"tag":85,"props":3700,"children":3701},{"style":743},[3702],{"type":21,"value":3703}," \"admin=true&\"\n",{"type":16,"tag":85,"props":3705,"children":3707},{"class":87,"line":3706},122,[3708],{"type":16,"tag":85,"props":3709,"children":3710},{"style":329},[3711],{"type":21,"value":3712},"    # construct the admin cookie\n",{"type":16,"tag":85,"props":3714,"children":3716},{"class":87,"line":3715},123,[3717,3722,3726,3731,3735,3740],{"type":16,"tag":85,"props":3718,"children":3719},{"style":92},[3720],{"type":21,"value":3721},"    cons ",{"type":16,"tag":85,"props":3723,"children":3724},{"style":98},[3725],{"type":21,"value":568},{"type":16,"tag":85,"props":3727,"children":3728},{"style":92},[3729],{"type":21,"value":3730}," encryptVig(admin_val, ciphers[",{"type":16,"tag":85,"props":3732,"children":3733},{"style":98},[3734],{"type":21,"value":1342},{"type":16,"tag":85,"props":3736,"children":3737},{"style":118},[3738],{"type":21,"value":3739},"3",{"type":16,"tag":85,"props":3741,"children":3742},{"style":92},[3743],{"type":21,"value":3584},{"type":16,"tag":85,"props":3745,"children":3747},{"class":87,"line":3746},124,[3748,3752,3756],{"type":16,"tag":85,"props":3749,"children":3750},{"style":92},[3751],{"type":21,"value":3721},{"type":16,"tag":85,"props":3753,"children":3754},{"style":98},[3755],{"type":21,"value":568},{"type":16,"tag":85,"props":3757,"children":3758},{"style":92},[3759],{"type":21,"value":3760}," encryptRailFence(cons, rf_key)\n",{"type":16,"tag":85,"props":3762,"children":3764},{"class":87,"line":3763},125,[3765,3770,3774,3778,3782,3786],{"type":16,"tag":85,"props":3766,"children":3767},{"style":92},[3768],{"type":21,"value":3769},"    ciphers[",{"type":16,"tag":85,"props":3771,"children":3772},{"style":98},[3773],{"type":21,"value":1342},{"type":16,"tag":85,"props":3775,"children":3776},{"style":118},[3777],{"type":21,"value":139},{"type":16,"tag":85,"props":3779,"children":3780},{"style":92},[3781],{"type":21,"value":514},{"type":16,"tag":85,"props":3783,"children":3784},{"style":98},[3785],{"type":21,"value":568},{"type":16,"tag":85,"props":3787,"children":3788},{"style":92},[3789],{"type":21,"value":3790}," cons\n",{"type":16,"tag":85,"props":3792,"children":3794},{"class":87,"line":3793},126,[3795],{"type":16,"tag":85,"props":3796,"children":3797},{"style":329},[3798],{"type":21,"value":3799},"    # print admin cookie\n",{"type":16,"tag":85,"props":3801,"children":3803},{"class":87,"line":3802},127,[3804,3808,3813,3818,3823,3827,3831],{"type":16,"tag":85,"props":3805,"children":3806},{"style":441},[3807],{"type":21,"value":3670},{"type":16,"tag":85,"props":3809,"children":3810},{"style":92},[3811],{"type":21,"value":3812},"(hexlify(",{"type":16,"tag":85,"props":3814,"children":3815},{"style":743},[3816],{"type":21,"value":3817},"''",{"type":16,"tag":85,"props":3819,"children":3820},{"style":92},[3821],{"type":21,"value":3822},".join(ciphers[:",{"type":16,"tag":85,"props":3824,"children":3825},{"style":98},[3826],{"type":21,"value":1342},{"type":16,"tag":85,"props":3828,"children":3829},{"style":118},[3830],{"type":21,"value":121},{"type":16,"tag":85,"props":3832,"children":3833},{"style":92},[3834],{"type":21,"value":3835},"]).encode()))\n",{"type":16,"tag":17,"props":3837,"children":3838},{},[3839],{"type":21,"value":3840},"Finally, I only got a new cookie by registering, constructed a valid admin cookie from it, used it to login and get the flag :)",{"type":16,"tag":74,"props":3842,"children":3844},{"className":76,"code":3843,"language":78,"meta":7,"style":7},"[youben@ym ~]$ ncat 52.59.5.86 1111\n[1] register\n[2] login\n1\n[+] name:\naaaaaa\n[+] password:\n\n[+] this is your hex-encoded cookie: 2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d7a73530c0b66227736200b4174540c30\n[1] register\n[2] login\n2\n[+] cookie(in hex):\n2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d4e4a22515b\nMCTF{mochi_mochi,CBC desu?!}\n[1] register\n[2] login\n",[3845],{"type":16,"tag":81,"props":3846,"children":3847},{"__ignoreMap":7},[3848,3863,3878,3893,3900,3907,3915,3922,3929,3937,3952,3967,3974,3981,3989,4007,4022],{"type":16,"tag":85,"props":3849,"children":3850},{"class":87,"line":88},[3851,3855,3859],{"type":16,"tag":85,"props":3852,"children":3853},{"style":92},[3854],{"type":21,"value":95},{"type":16,"tag":85,"props":3856,"children":3857},{"style":98},[3858],{"type":21,"value":101},{"type":16,"tag":85,"props":3860,"children":3861},{"style":92},[3862],{"type":21,"value":106},{"type":16,"tag":85,"props":3864,"children":3865},{"class":87,"line":109},[3866,3870,3874],{"type":16,"tag":85,"props":3867,"children":3868},{"style":92},[3869],{"type":21,"value":115},{"type":16,"tag":85,"props":3871,"children":3872},{"style":118},[3873],{"type":21,"value":121},{"type":16,"tag":85,"props":3875,"children":3876},{"style":92},[3877],{"type":21,"value":126},{"type":16,"tag":85,"props":3879,"children":3880},{"class":87,"line":129},[3881,3885,3889],{"type":16,"tag":85,"props":3882,"children":3883},{"style":92},[3884],{"type":21,"value":115},{"type":16,"tag":85,"props":3886,"children":3887},{"style":118},[3888],{"type":21,"value":139},{"type":16,"tag":85,"props":3890,"children":3891},{"style":92},[3892],{"type":21,"value":144},{"type":16,"tag":85,"props":3894,"children":3895},{"class":87,"line":147},[3896],{"type":16,"tag":85,"props":3897,"children":3898},{"style":151},[3899],{"type":21,"value":154},{"type":16,"tag":85,"props":3901,"children":3902},{"class":87,"line":157},[3903],{"type":16,"tag":85,"props":3904,"children":3905},{"style":92},[3906],{"type":21,"value":163},{"type":16,"tag":85,"props":3908,"children":3909},{"class":87,"line":166},[3910],{"type":16,"tag":85,"props":3911,"children":3912},{"style":151},[3913],{"type":21,"value":3914},"aaaaaa\n",{"type":16,"tag":85,"props":3916,"children":3917},{"class":87,"line":175},[3918],{"type":16,"tag":85,"props":3919,"children":3920},{"style":92},[3921],{"type":21,"value":181},{"type":16,"tag":85,"props":3923,"children":3924},{"class":87,"line":184},[3925],{"type":16,"tag":85,"props":3926,"children":3927},{"emptyLinePlaceholder":338},[3928],{"type":21,"value":341},{"type":16,"tag":85,"props":3930,"children":3931},{"class":87,"line":193},[3932],{"type":16,"tag":85,"props":3933,"children":3934},{"style":92},[3935],{"type":21,"value":3936},"[+] this is your hex-encoded cookie: 2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d7a73530c0b66227736200b4174540c30\n",{"type":16,"tag":85,"props":3938,"children":3939},{"class":87,"line":202},[3940,3944,3948],{"type":16,"tag":85,"props":3941,"children":3942},{"style":92},[3943],{"type":21,"value":115},{"type":16,"tag":85,"props":3945,"children":3946},{"style":118},[3947],{"type":21,"value":121},{"type":16,"tag":85,"props":3949,"children":3950},{"style":92},[3951],{"type":21,"value":126},{"type":16,"tag":85,"props":3953,"children":3954},{"class":87,"line":218},[3955,3959,3963],{"type":16,"tag":85,"props":3956,"children":3957},{"style":92},[3958],{"type":21,"value":115},{"type":16,"tag":85,"props":3960,"children":3961},{"style":118},[3962],{"type":21,"value":139},{"type":16,"tag":85,"props":3964,"children":3965},{"style":92},[3966],{"type":21,"value":144},{"type":16,"tag":85,"props":3968,"children":3969},{"class":87,"line":234},[3970],{"type":16,"tag":85,"props":3971,"children":3972},{"style":151},[3973],{"type":21,"value":240},{"type":16,"tag":85,"props":3975,"children":3976},{"class":87,"line":243},[3977],{"type":16,"tag":85,"props":3978,"children":3979},{"style":92},[3980],{"type":21,"value":249},{"type":16,"tag":85,"props":3982,"children":3983},{"class":87,"line":252},[3984],{"type":16,"tag":85,"props":3985,"children":3986},{"style":151},[3987],{"type":21,"value":3988},"2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d4e4a22515b\n",{"type":16,"tag":85,"props":3990,"children":3991},{"class":87,"line":261},[3992,3997,4002],{"type":16,"tag":85,"props":3993,"children":3994},{"style":151},[3995],{"type":21,"value":3996},"MCTF",{"type":16,"tag":85,"props":3998,"children":3999},{"style":92},[4000],{"type":21,"value":4001},"{mochi_mochi,CBC ",{"type":16,"tag":85,"props":4003,"children":4004},{"style":743},[4005],{"type":21,"value":4006},"desu?!}\n",{"type":16,"tag":85,"props":4008,"children":4009},{"class":87,"line":280},[4010,4014,4018],{"type":16,"tag":85,"props":4011,"children":4012},{"style":92},[4013],{"type":21,"value":115},{"type":16,"tag":85,"props":4015,"children":4016},{"style":118},[4017],{"type":21,"value":121},{"type":16,"tag":85,"props":4019,"children":4020},{"style":92},[4021],{"type":21,"value":126},{"type":16,"tag":85,"props":4023,"children":4024},{"class":87,"line":296},[4025,4029,4033],{"type":16,"tag":85,"props":4026,"children":4027},{"style":92},[4028],{"type":21,"value":115},{"type":16,"tag":85,"props":4030,"children":4031},{"style":118},[4032],{"type":21,"value":139},{"type":16,"tag":85,"props":4034,"children":4035},{"style":92},[4036],{"type":21,"value":144},{"type":16,"tag":17,"props":4038,"children":4039},{},[4040,4042,4049],{"type":21,"value":4041},"Thanks to ",{"type":16,"tag":24,"props":4043,"children":4046},{"href":4044,"rel":4045},"https://www.facebook.com/th3jackers",[28],[4047],{"type":21,"value":4048},"th3jackers",{"type":21,"value":4050}," for the nice challenge.",{"type":16,"tag":4052,"props":4053,"children":4054},"style",{},[4055],{"type":21,"value":4056},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",{"title":7,"searchDepth":109,"depth":109,"links":4058},[4059,4060],{"id":37,"depth":109,"text":40},{"id":64,"depth":109,"text":67},"markdown","content:blog:mctf-2019-back-to-the-old-days.md","content","blog/mctf-2019-back-to-the-old-days.md","md",1717938435608]