<!DOCTYPE html>
<html class="no-js" lang="en-us" scroll-behavior="smooth"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="There is a group of hackers that we&amp;rsquo;ve been trying to take down for a while, we had a spy among them but his cover was compromised, but he managed to leak a piece of code&amp;hellip;">
    <meta name="author" content="Ayoub Benaissa">

    <!-- Mobile Specific Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.59.0" />

    <title>MCTF Final 2019 Writeup - Back to the Old Ways | Blogs</title>


    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="https://www.ayoub-benaissa.com/images/favicon.ico"/>

    <!-- CSS -->
    <!-- Fontawesome Icon font -->
    <link rel="stylesheet" href="https://www.ayoub-benaissa.com/plugins/themefisher-font/style.css">
    <!-- bootstrap.min css -->
    <link rel="stylesheet" href="https://www.ayoub-benaissa.com/plugins/bootstrap/dist/css/bootstrap.min.css">
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://www.ayoub-benaissa.com/plugins/animate-css/animate.css">
    <!-- Magnific popup css -->
    <link rel="stylesheet" href="https://www.ayoub-benaissa.com/plugins/magnific-popup/dist/magnific-popup.css">
    <!-- Slick Carousel -->
    <link rel="stylesheet" href="https://www.ayoub-benaissa.com/plugins/slick-carousel/slick/slick.css">
    <link rel="stylesheet" href="https://www.ayoub-benaissa.com/plugins/slick-carousel/slick/slick-theme.css">
    <!-- Main Stylesheet -->
    
    <link rel="stylesheet" href="https://www.ayoub-benaissa.com/css/style.min.css" integrity="" media="screen">

</head>
<body id="body" data-spy="scroll" data-target=".navbar" data-offset="52">
        <div id="content">

<!-- Fixed Navigation -->
<nav id="navigation" class="navbar navbar-expand-lg navigation sticky-top">
        <div class="container">

                <!-- logo -->
                <a class="navbar-brand logo" href="https://www.ayoub-benaissa.com/">
                        <img src="https://www.ayoub-benaissa.com/images/logos/logo.png" alt="Logo" />
                        <span class="pl-2 font-weight-bold">Ayoub Benaissa</span>
                </a>
                <!-- /logo -->

                <!-- responsive nav button -->
                <button class="navbar-toggler navbar-dark" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                </button>
                <!-- /responsive nav button -->

                <!-- main nav -->
                
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav ml-auto navigation-menu">
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://www.ayoub-benaissa.com/#body">Home</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://www.ayoub-benaissa.com/#about">About Me</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://www.ayoub-benaissa.com/#experience">Experience</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://www.ayoub-benaissa.com/#portfolio">Portfolio</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://www.ayoub-benaissa.com/#blog">Blog</a></li>
                                
                                <li class="nav-item"><a class="nav-link" data-scroll href="https://www.ayoub-benaissa.com/#contact-me">Contact</a></li>
                                
                        </ul>
                </div>
                
                <!-- /main nav -->
        </div>

</nav>
<!-- End Fixed Navigation -->


<section class="section">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 offset-lg-2 text-center">
                <h1>MCTF Final 2019 Writeup - Back to the Old Ways</h1>
                <ul class="list-inline mb-50">
                    <li class="list-inline-item"><a href="/author/"></a></li>
                    <li class="list-inline-item">Tuesday, Jul 30, 2019</li>
                </ul>
                <img class="img-fluid mb-50" src="https://www.ayoub-benaissa.com/images/blog/mini/mctffinal2019.jpg" alt="blog-image">
            </div>
            <div class="col-lg-8 offset-lg-2">
                <div class="post-single-content">
                    

<p><span style="color: #BEBEBE">
I played MCTF final 2019 with <a href="https://web.facebook.com/sud0r00t/">my team</a> this week and wanted to share a writeup for the &lsquo;Back to the old ways&rsquo; crypto challenge.
</span></p>

<h2 id="challenge-description">Challenge description</h2>

<p><span style="color: #BEBEBE">
There is a group of hackers that we&rsquo;ve been trying to take down for a while, we had a spy among them but his cover was compromised, but he managed to leak a piece of code running on their main socket, try to get admin access.
</span></p>

<p><span style="color: #BEBEBE">
nc 52.59.5.86 1111
</span></p>

<p><span style="color: #BEBEBE">
<strong>Objective:</strong> Get admin access
</span></p>

<h2 id="solution">Solution</h2>

<p><span style="color: #BEBEBE">
I first tried to use the public service
<span></p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>youben@ym ~<span style="color:#f92672">]</span>$ ncat <span style="color:#ae81ff">52</span>.59.5.86 <span style="color:#ae81ff">1111</span>
<span style="color:#f92672">[</span><span style="color:#ae81ff">1</span><span style="color:#f92672">]</span> register
<span style="color:#f92672">[</span><span style="color:#ae81ff">2</span><span style="color:#f92672">]</span> login
<span style="color:#ae81ff">1</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> name:
youben
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> password:
password
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> this is your hex-encoded cookie: 6625205b724457776f2e753f7c3463542a3f584254547d6a77493c0b09714c3a2761476358606a6e45653a5d
<span style="color:#f92672">[</span><span style="color:#ae81ff">1</span><span style="color:#f92672">]</span> register
<span style="color:#f92672">[</span><span style="color:#ae81ff">2</span><span style="color:#f92672">]</span> login
<span style="color:#ae81ff">2</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> cookie<span style="color:#f92672">(</span>in hex<span style="color:#f92672">)</span>:
6625205b724457776f2e753f7c3463542a3f584254547d6a77493c0b09714c3a2761476358606a6e45653a5d
<span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> access is <span style="color:#66d9ef">for</span> admins only
<span style="color:#f92672">[</span><span style="color:#ae81ff">1</span><span style="color:#f92672">]</span> register
<span style="color:#f92672">[</span><span style="color:#ae81ff">2</span><span style="color:#f92672">]</span> login</code></pre></div>

<p><span style="color: #BEBEBE">
It seems like our information are stored in that cookie and are checked when we try to login to see if we have admin rights. So the goal is to construct a valid admin cookie. Let&rsquo;s check the provided code
</span></p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#all what u need is here</span>

<span style="color:#f92672">from</span> string <span style="color:#f92672">import</span> printable <span style="color:#66d9ef">as</span> alpha

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(msg,key,iv):
    <span style="color:#66d9ef">if</span> len(msg) <span style="color:#f92672">%</span> <span style="color:#ae81ff">11</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
        msg <span style="color:#f92672">+=</span> alpha[len(msg) <span style="color:#f92672">%</span> <span style="color:#ae81ff">11</span>] <span style="color:#f92672">*</span> (<span style="color:#ae81ff">11</span> <span style="color:#f92672">-</span> len(msg) <span style="color:#f92672">%</span> <span style="color:#ae81ff">11</span>)
    l <span style="color:#f92672">=</span> [msg[i:i<span style="color:#f92672">+</span><span style="color:#ae81ff">11</span>] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(msg),<span style="color:#ae81ff">11</span>)]
    ct <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> l:
        tmp <span style="color:#f92672">=</span> viginereEncrypt(i,iv)
        tmp <span style="color:#f92672">=</span> railFenceEncrypt(tmp,key)
        ct<span style="color:#f92672">.</span>append(tmp)
        iv <span style="color:#f92672">=</span> tmp
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(ct)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(msg,key,iv):
    l <span style="color:#f92672">=</span> [msg[i:i<span style="color:#f92672">+</span><span style="color:#ae81ff">11</span>] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(msg),<span style="color:#ae81ff">11</span>)]
    pt <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> l:
        tmp <span style="color:#f92672">=</span> railFenceDecrypt(i,key)
        tmp <span style="color:#f92672">=</span> viginereDecrypt(tmp,iv)
        pt<span style="color:#f92672">.</span>append(tmp)
        iv <span style="color:#f92672">=</span> i
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(pt)</code></pre></div>

<p><span style="color: #BEBEBE">
The encryption can be illustrated in the figure below
</span></p>

<p align="center">
  <img width="85%" height="auto" src="/images/blog/cbc.png">
</p>

<p><span style="color: #BEBEBE">
It&rsquo;s using vigenere and railfence in <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">CBC</a> mode, the keyspace for railfence here is computable (only 10 possible keys), so if we know the last plaintext then we can just try decrypting the last ciphertext with the possible keys until we found the correct one that decrypts to our know plaintext, thanks to the padding for that, if len(plaintext) % 11 == 1 then it will be padded with 10 &lsquo;1&rsquo;, however, we must first understand how it&rsquo;s constructing the plaintext cookie.
</span></p>

<p><span style="color: #BEBEBE">
Trying different inputs, I discovered that a name and password of length 6 + 11k gives us a padding of 10 &lsquo;1&rsquo;, so we can now decrypt the last block with the 10 possible keys and check until we get those 10 &lsquo;1&rsquo; and decrypt the whole cookie except the first block cause we don&rsquo;t have the IV.
</span></p>

<p><span style="color: #BEBEBE">
Decrypting the cookie gave me &lsquo;](yv$zHX?B)&amp;password=&amp;admin=false&amp;1111111111&rsquo;, seems like we only need to replace that &lsquo;false&rsquo; with a &lsquo;true&rsquo; and reconstruct a valid cookie. You can check the complete code for doing that below
</span></p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> string <span style="color:#f92672">import</span> printable <span style="color:#66d9ef">as</span> alpha
<span style="color:#f92672">from</span> binascii <span style="color:#f92672">import</span> unhexlify, hexlify


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encryptRailFence</span>(text, key):
    rail <span style="color:#f92672">=</span> [[<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(text))]
                  <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(key)]
    dir_down <span style="color:#f92672">=</span> False
    row, col <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>

    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(text)):
        <span style="color:#66d9ef">if</span> (row <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">or</span> (row <span style="color:#f92672">==</span> key <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>):
            dir_down <span style="color:#f92672">=</span> <span style="color:#f92672">not</span> dir_down

        rail[row][col] <span style="color:#f92672">=</span> text[i]
        col <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">if</span> dir_down:
            row <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">else</span>:
            row <span style="color:#f92672">-=</span> <span style="color:#ae81ff">1</span>
    result <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(key):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(text)):
            <span style="color:#66d9ef">if</span> rail[i][j] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>:
                result<span style="color:#f92672">.</span>append(rail[i][j])
    <span style="color:#66d9ef">return</span>(<span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">.</span> join(result))


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decryptRailFence</span>(cipher, key):
    rail <span style="color:#f92672">=</span> [[<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(cipher))]
                  <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(key)]
    dir_down <span style="color:#f92672">=</span> None
    row, col <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>

    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(cipher)):
        <span style="color:#66d9ef">if</span> row <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            dir_down <span style="color:#f92672">=</span> True
        <span style="color:#66d9ef">if</span> row <span style="color:#f92672">==</span> key <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>:
            dir_down <span style="color:#f92672">=</span> False

        rail[row][col] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*&#39;</span>
        col <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>

        <span style="color:#66d9ef">if</span> dir_down:
            row <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">else</span>:
            row <span style="color:#f92672">-=</span> <span style="color:#ae81ff">1</span>
    index <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(key):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(cipher)):
            <span style="color:#66d9ef">if</span> ((rail[i][j] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;*&#39;</span>) <span style="color:#f92672">and</span>
               (index <span style="color:#f92672">&lt;</span> len(cipher))):
                rail[i][j] <span style="color:#f92672">=</span> cipher[index]
                index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    result <span style="color:#f92672">=</span> []
    row, col <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(cipher)):
        <span style="color:#66d9ef">if</span> row <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            dir_down <span style="color:#f92672">=</span> True
        <span style="color:#66d9ef">if</span> row <span style="color:#f92672">==</span> key<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
            dir_down <span style="color:#f92672">=</span> False
        <span style="color:#66d9ef">if</span> (rail[row][col] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;*&#39;</span>):
            result<span style="color:#f92672">.</span>append(rail[row][col])
            col <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">if</span> dir_down:
            row <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">else</span>:
            row <span style="color:#f92672">-=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span>(<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(result))


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decryptVig</span>(ciphertext, key):
    key_length <span style="color:#f92672">=</span> len(key)
    key_as_int <span style="color:#f92672">=</span> [alpha<span style="color:#f92672">.</span>find(k) <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> key]
    ciphertext_int <span style="color:#f92672">=</span> [alpha<span style="color:#f92672">.</span>find(c) <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> ciphertext]
    plaintext <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(ciphertext_int)):
        p <span style="color:#f92672">=</span> (ciphertext_int[i] <span style="color:#f92672">-</span> key_as_int[i <span style="color:#f92672">%</span> key_length]) <span style="color:#f92672">%</span> len(alpha)
        plaintext <span style="color:#f92672">+=</span> alpha[p]
    <span style="color:#66d9ef">return</span> plaintext


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encryptVig</span>(plaintext, key):
    key_length <span style="color:#f92672">=</span> len(key)
    key_as_int <span style="color:#f92672">=</span> [alpha<span style="color:#f92672">.</span>find(k) <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> key]
    plaintext_int <span style="color:#f92672">=</span> [alpha<span style="color:#f92672">.</span>find(p) <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> plaintext]
    ciphertext <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(plaintext_int)):
        c <span style="color:#f92672">=</span> (plaintext_int[i] <span style="color:#f92672">+</span> key_as_int[i <span style="color:#f92672">%</span> key_length]) <span style="color:#f92672">%</span> len(alpha)
        ciphertext <span style="color:#f92672">+=</span> alpha[c]
    <span style="color:#66d9ef">return</span> ciphertext


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(msg,key,iv):
    l <span style="color:#f92672">=</span> [msg[i:i<span style="color:#f92672">+</span><span style="color:#ae81ff">11</span>] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(msg),<span style="color:#ae81ff">11</span>)]
    pt <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> l:
        tmp <span style="color:#f92672">=</span> decryptRailFence(i,key)
        tmp <span style="color:#f92672">=</span> decryptVig(tmp,iv)
        pt<span style="color:#f92672">.</span>append(tmp)
        iv <span style="color:#f92672">=</span> i
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(pt)


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    <span style="color:#75715e"># name: &#39;aaaaaa&#39;</span>
    <span style="color:#75715e"># password: &#39;&#39;</span>
    expected_chars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span>
    cookie <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d7a73530c0b66227736200b4174540c30&#34;</span>
    cipher <span style="color:#f92672">=</span> unhexlify(cookie)<span style="color:#f92672">.</span>decode()
    ciphers <span style="color:#f92672">=</span> [cipher[i:i<span style="color:#f92672">+</span><span style="color:#ae81ff">11</span>] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(cipher), <span style="color:#ae81ff">11</span>)]
    last_cipher <span style="color:#f92672">=</span> ciphers[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    rf_key <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">11</span>):
        p <span style="color:#f92672">=</span> decryptRailFence(last_cipher, i)
        p <span style="color:#f92672">=</span> decryptVig(p, ciphers[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>])
        <span style="color:#66d9ef">if</span> expected_chars <span style="color:#f92672">in</span> p:
            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Found RF key: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i)
            rf_key <span style="color:#f92672">=</span> i
    <span style="color:#66d9ef">print</span>(decrypt(cipher, rf_key, <span style="color:#e6db74">&#34;0&#34;</span>))
    admin_val <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;admin=true&amp;&#34;</span>
    <span style="color:#75715e"># construct the admin cookie</span>
    cons <span style="color:#f92672">=</span> encryptVig(admin_val, ciphers[<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>])
    cons <span style="color:#f92672">=</span> encryptRailFence(cons, rf_key)
    ciphers[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> cons
    <span style="color:#75715e"># print admin cookie</span>
    <span style="color:#66d9ef">print</span>(hexlify(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(ciphers[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])<span style="color:#f92672">.</span>encode()))</code></pre></div>

<p><span style="color: #BEBEBE">
Finally, I only got a new cookie by registering, constructed a valid admin cookie from it, used it to login and get the flag :)
</span></p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>youben@ym ~<span style="color:#f92672">]</span>$ ncat <span style="color:#ae81ff">52</span>.59.5.86 <span style="color:#ae81ff">1111</span>
<span style="color:#f92672">[</span><span style="color:#ae81ff">1</span><span style="color:#f92672">]</span> register
<span style="color:#f92672">[</span><span style="color:#ae81ff">2</span><span style="color:#f92672">]</span> login
<span style="color:#ae81ff">1</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> name:
aaaaaa
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> password:

<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> this is your hex-encoded cookie: 2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d7a73530c0b66227736200b4174540c30
<span style="color:#f92672">[</span><span style="color:#ae81ff">1</span><span style="color:#f92672">]</span> register
<span style="color:#f92672">[</span><span style="color:#ae81ff">2</span><span style="color:#f92672">]</span> login
<span style="color:#ae81ff">2</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> cookie<span style="color:#f92672">(</span>in hex<span style="color:#f92672">)</span>:
2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d4e4a22515b
MCTF<span style="color:#f92672">{</span>mochi_mochi,CBC desu?!<span style="color:#f92672">}</span>
<span style="color:#f92672">[</span><span style="color:#ae81ff">1</span><span style="color:#f92672">]</span> register
<span style="color:#f92672">[</span><span style="color:#ae81ff">2</span><span style="color:#f92672">]</span> login</code></pre></div>

<p><br/></p>

<p><span style="color: #BEBEBE">
Thanks to <a href="https://www.facebook.com/th3jackers">th3jackers</a> for the nice challenge.
</span></p>

                    
                        

<div class="social-share pt-4">
        <h4>Share:</h4>
        
        <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.ayoub-benaissa.com%2fblog%2fmctf-2019-back-to-the-old-days%2f" target="_blank" rel="noopener" aria-label="">
            <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg>
            </div>
        </div>
    </a>

    
    <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=MCTF%20Final%202019%20Writeup%20-%20Back%20to%20the%20Old%20Ways&amp;url=https%3a%2f%2fwww.ayoub-benaissa.com%2fblog%2fmctf-2019-back-to-the-old-days%2f" target="_blank" rel="noopener" aria-label="">
        <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg>
        </div>
    </div>
</a>


<a class="resp-sharing-button__link" href="https://plus.google.com/share?url=https%3a%2f%2fwww.ayoub-benaissa.com%2fblog%2fmctf-2019-back-to-the-old-days%2f" target="_blank" rel="noopener" aria-label="">
    <div class="resp-sharing-button resp-sharing-button--google resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.37 12.93c-.73-.52-1.4-1.27-1.4-1.5 0-.43.03-.63.98-1.37 1.23-.97 1.9-2.23 1.9-3.57 0-1.22-.36-2.3-1-3.05h.5c.1 0 .2-.04.28-.1l1.36-.98c.16-.12.23-.34.17-.54-.07-.2-.25-.33-.46-.33H7.6c-.66 0-1.34.12-2 .35-2.23.76-3.78 2.66-3.78 4.6 0 2.76 2.13 4.85 5 4.9-.07.23-.1.45-.1.66 0 .43.1.83.33 1.22h-.08c-2.72 0-5.17 1.34-6.1 3.32-.25.52-.37 1.04-.37 1.56 0 .5.13.98.38 1.44.6 1.04 1.84 1.86 3.55 2.28.87.23 1.82.34 2.8.34.88 0 1.7-.1 2.5-.34 2.4-.7 3.97-2.48 3.97-4.54 0-1.97-.63-3.15-2.33-4.35zm-7.7 4.5c0-1.42 1.8-2.68 3.9-2.68h.05c.45 0 .9.07 1.3.2l.42.28c.96.66 1.6 1.1 1.77 1.8.05.16.07.33.07.5 0 1.8-1.33 2.7-3.96 2.7-1.98 0-3.54-1.23-3.54-2.8zM5.54 3.9c.33-.38.75-.58 1.23-.58h.05c1.35.05 2.64 1.55 2.88 3.35.14 1.02-.08 1.97-.6 2.55-.32.37-.74.56-1.23.56h-.03c-1.32-.04-2.63-1.6-2.87-3.4-.13-1 .08-1.92.58-2.5zM23.5 9.5h-3v-3h-2v3h-3v2h3v3h2v-3h3"/></svg>
    </div>
</div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=MCTF%20Final%202019%20Writeup%20-%20Back%20to%20the%20Old%20Ways&amp;body=https%3a%2f%2fwww.ayoub-benaissa.com%2fblog%2fmctf-2019-back-to-the-old-days%2f" target="_self" rel="noopener" aria-label="">
    <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg>
    </div>
</div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fwww.ayoub-benaissa.com%2fblog%2fmctf-2019-back-to-the-old-days%2f&amp;resubmit=true&amp;title=MCTF%20Final%202019%20Writeup%20-%20Back%20to%20the%20Old%20Ways" target="_blank" rel="noopener" aria-label="">
    <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg>
    </div>
</div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=MCTF%20Final%202019%20Writeup%20-%20Back%20to%20the%20Old%20Ways%20https%3a%2f%2fwww.ayoub-benaissa.com%2fblog%2fmctf-2019-back-to-the-old-days%2f" target="_blank" rel="noopener" aria-label="">
    <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3 0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7 0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1 0-5.2 4.2-9.4 9.4-9.4 2.5 0 4.9 1 6.7 2.8 1.8 1.8 2.8 4.2 2.8 6.7-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6s.3-.3.4-.5c.2-.1.3-.3.4-.5.1-.2 0-.4 0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg>
    </div>
</div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=MCTF%20Final%202019%20Writeup%20-%20Back%20to%20the%20Old%20Ways&amp;url=https%3a%2f%2fwww.ayoub-benaissa.com%2fblog%2fmctf-2019-back-to-the-old-days%2f" target="_blank" rel="noopener" aria-label="">
    <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64 0 9.508 0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102 0 0 0 1.75.527l2.96-2.41a.405.405 0 0 1 .494-.013l5.34 3.87a1.1 1.1 0 0 0 1.046.135 1.1 1.1 0 0 0 .682-.803l3.91-18.795A1.102 1.102 0 0 0 22.5.075L.706 8.475z"/></svg>
    </div>
</div>
</a>

</div>
                    
                    <br/>
                    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "discussion-youben-blog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                    

                </div>
            </div>
        </div>
    </div>
</section>


        </div><!-- end Contact Area -->
<footer id="footer" class="bg-one">
	<div class="container">
		<div class="row wow fadeInUp" data-wow-duration="500ms">
			<div class="col-xl-12">

				<!-- Footer Social Links -->
				<div class="social-icon">
					<ul class="list-inline">
						
						<li class="list-inline-item"><a href="https://twitter.com/y0uben11"><i class="tf-ion-social-twitter"></i></a></li>
						
						<li class="list-inline-item"><a href="mailto:ayoub.benaissa.ab@gmail.com"><i class="tf-ion-android-mail"></i></a></li>
						
						<li class="list-inline-item"><a href="https://github.com/youben11"><i class="tf-ion-social-github"></i></a></li>
						
						<li class="list-inline-item"><a href="https://www.linkedin.com/in/ayoub-benaissa/"><i class="tf-ion-social-linkedin"></i></a></li>
						
						<li class="list-inline-item"><a href="https://www.freelancer.com/u/youben11"><i class="tf-ion-social-facebook"></i></a></li>
						
					</ul>
				</div>

				<!-- copyright -->
				<div class="copyright text-center">
					<a href="https://www.ayoub-benaissa.com/">
						<img src="https://www.ayoub-benaissa.com/images/logos/logo.png" alt="Meghna" />
					</a>
					<br>
					<p>Design And Developed by <a href="http://www.themefisher.com">  Themefisher Team  </a> and adapted by <a href="#">Ayoub Benaissa</a>. Copyright &copy; <script>
							document.write(new Date().getFullYear())
						</script>. All Rights Reserved.</p>
				</div>
			</div>
		</div>
	</div>
</footer>
<!-- /footer -->

<!-- Essential Scripts -->

		<!-- Main jQuery -->
		<script type="text/javascript" src="https://www.ayoub-benaissa.com/plugins/jquery/dist/jquery.min.js"></script>
		<!-- Bootstrap 4.3 + Popper -->
		<script type="text/javascript" src="https://www.ayoub-benaissa.com/plugins/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
		<!-- Slick Carousel -->
		<script type="text/javascript" src="https://www.ayoub-benaissa.com/plugins/slick-carousel/slick/slick.min.js"></script>
		<!-- Portfolio Filtering -->
		<script type="text/javascript" src="https://www.ayoub-benaissa.com/plugins/filterzr/jquery.filterizr.min.js"></script>
		<!-- Magnific popup -->
		<script type="text/javascript" src="https://www.ayoub-benaissa.com/plugins/magnific-popup/dist/jquery.magnific-popup.min.js"></script>
		<!-- Google Map API -->
		<script type="text/javascript"  src="https://www.ayoub-benaissa.com/"></script>
		<!-- Number Counter Script -->
		<script type="text/javascript" src="https://www.ayoub-benaissa.com/plugins/count-to/jquery.countTo.js"></script>
		<!-- wow.min Script -->
		<script type="text/javascript" src="https://www.ayoub-benaissa.com/plugins/wow/dist/wow.min.js"></script>
		<!-- Scroll behavior polyfill -->
		
		<script src="https://www.ayoub-benaissa.com/js/scroll-behavior-polyfill.min.js"></script>
		<!-- Sweet Alert -->
		<script type="text/javascript" src="https://www.ayoub-benaissa.com/plugins/sweet-alert/sweetalert.min.js"></script>
		<!-- Custom js -->
		
		<script src="https://www.ayoub-benaissa.com/js/script.min.js"></script>

    </body>
</html>
</body>
</html>
