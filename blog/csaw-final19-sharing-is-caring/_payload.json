[{"data":1,"prerenderedAt":320},["Reactive",2],{"content-query-AWaZrs0AFQ":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"date":10,"image":11,"draft":6,"body":12,"_type":315,"_id":316,"_source":317,"_file":318,"_extension":319},"/blog/csaw-final19-sharing-is-caring","blog",false,"","CSAW'19 CTF Finals Writeup - Sharing is Caring","Cyber Security Awareness Worldwide is the most comprehensive student-run cyber security event in the world, featuring nine competitions, 6 global hosts, workshops, and industry events.","2019-11-11T00:00:00.000Z","/img/csaw-ctf-logo.png",{"type":13,"children":14,"toc":311},"root",[15,34,41,46,60,66,71,84,114,119,305],{"type":16,"tag":17,"props":18,"children":19},"element","p",{},[20,23,32],{"type":21,"value":22},"text","Last week we (",{"type":16,"tag":24,"props":25,"children":29},"a",{"href":26,"rel":27},"https://twitter.com/Sudo_root_team",[28],"nofollow",[30],{"type":21,"value":31},"Sudo_root",{"type":21,"value":33},") played the CSAW'19 CTF in the MENA region and got the second place, the challenges were great and full of crypto, I personally liked the sharing is caring challenge which was worth 500 points so I'm making a writeup about it.",{"type":16,"tag":35,"props":36,"children":38},"h2",{"id":37},"challenge-description",[39],{"type":21,"value":40},"Challenge description",{"type":16,"tag":17,"props":42,"children":43},{},[44],{"type":21,"value":45},"The challenge tells us that 'sharing is caring!' and it was just hinting that the challenge was about a secret sharing scheme. The goal was to recover the secret under certain conditions, the most basic one is that we can only get up to threshold-1 shares (otherwise the challenge would be about doing calculations), however, we were able to find an additional free share and thus recover the secret really easily.",{"type":16,"tag":17,"props":47,"children":48},{},[49,51,58],{"type":21,"value":50},"The challenge provided a Python2 code that was running on the remote server and you can find it ",{"type":16,"tag":24,"props":52,"children":55},{"href":53,"rel":54},"https://github.com/osirislab/CSAW-CTF-2019-Finals/blob/master/crypto/sharing_is_caring/sharing_is_caring.py",[28],[56],{"type":21,"value":57},"here",{"type":21,"value":59},".",{"type":16,"tag":35,"props":61,"children":63},{"id":62},"solution",[64],{"type":21,"value":65},"Solution",{"type":16,"tag":17,"props":67,"children":68},{},[69],{"type":21,"value":70},"So the challenge was about secret sharing using polynoms, where single points were complex numbers,\nthe app server asks us to provide a polynom of degree higher or equal to 9000 (minimum threshold is 9001) and a threshold higher than 9000 and asks us about how many share we need, we can get up to THRESHOLD-1 shares, so the best is to have the maximum number of shares so we need to recover only one share to be able to get the secret. The main thing that I noticed is that no matters what polynom we provide, it will always map the value i=0 with the point (a0,0) (a0 is the coefficient of x^0 from our polynom), and since a0 is 0 in our case, this will just be a free share that we can use to do lagrange interpolation and recover the secret.",{"type":16,"tag":17,"props":72,"children":73},{},[74,76,82],{"type":21,"value":75},"The solution script for this challenge can be found ",{"type":16,"tag":24,"props":77,"children":80},{"href":78,"rel":79},"https://github.com/youben11/Writeups/tree/master/csaw_19_finals_sharing_is_caring_crypto500",[28],[81],{"type":21,"value":57},{"type":21,"value":83},", the main script is solve.py which will use a second sage script to do the heavy math. Basically the script will do the following:",{"type":16,"tag":85,"props":86,"children":87},"ul",{},[88,94,99,104,109],{"type":16,"tag":89,"props":90,"children":91},"li",{},[92],{"type":21,"value":93},"get the prime number used",{"type":16,"tag":89,"props":95,"children":96},{},[97],{"type":21,"value":98},"send the polynom, threshold and the number of shares to get",{"type":16,"tag":89,"props":100,"children":101},{},[102],{"type":21,"value":103},"get the shares and save them into files so the second script uses them",{"type":16,"tag":89,"props":105,"children":106},{},[107],{"type":21,"value":108},"run the lag.sage script to do the heavy math and recover the secret",{"type":16,"tag":89,"props":110,"children":111},{},[112],{"type":21,"value":113},"send the secret and get the flag!",{"type":16,"tag":17,"props":115,"children":116},{},[117],{"type":21,"value":118},"Below is the execution of solve.py",{"type":16,"tag":120,"props":121,"children":125},"pre",{"className":122,"code":123,"language":124,"meta":7,"style":7},"language-bash shiki shiki-themes monokai","[youben@ym sharing_is_caring]$ python2 solve.py \n[+] Opening connection to crypto.chal.csaw.io on port 1000: Done\n[+] Got prime 86279386867068376297302505847424156586494550934111236939596248557564380476339\n[+] Setting polynom to: 5x^1 + 87x^9000\n[+] Setting threshold to: 9001\n[+] Setting the number of shares to: 9000\n[+] Got the shares\n[*] Cracking secret...\n[+] Finished cracking with status 0\n[+] Got secret 33204634315060132722370276963862036606806159174093789534175596021531768399803\n[+] Got from server: '33204634315060132722370276963862036606806159174093789534175596021531768399803\n'\n[+] Got from server: 'flag{i_cant_believe_someone_else_found_a_cheese}\n'\n[+] Closed\n[*] Closed connection to crypto.chal.csaw.io port 1000\n","bash",[126],{"type":16,"tag":127,"props":128,"children":129},"code",{"__ignoreMap":7},[130,142,151,160,169,178,187,196,216,225,234,249,258,271,279,288],{"type":16,"tag":131,"props":132,"children":135},"span",{"class":133,"line":134},"line",1,[136],{"type":16,"tag":131,"props":137,"children":139},{"style":138},"--shiki-default:#F8F8F2",[140],{"type":21,"value":141},"[youben@ym sharing_is_caring]$ python2 solve.py \n",{"type":16,"tag":131,"props":143,"children":145},{"class":133,"line":144},2,[146],{"type":16,"tag":131,"props":147,"children":148},{"style":138},[149],{"type":21,"value":150},"[+] Opening connection to crypto.chal.csaw.io on port 1000: Done\n",{"type":16,"tag":131,"props":152,"children":154},{"class":133,"line":153},3,[155],{"type":16,"tag":131,"props":156,"children":157},{"style":138},[158],{"type":21,"value":159},"[+] Got prime 86279386867068376297302505847424156586494550934111236939596248557564380476339\n",{"type":16,"tag":131,"props":161,"children":163},{"class":133,"line":162},4,[164],{"type":16,"tag":131,"props":165,"children":166},{"style":138},[167],{"type":21,"value":168},"[+] Setting polynom to: 5x^1 + 87x^9000\n",{"type":16,"tag":131,"props":170,"children":172},{"class":133,"line":171},5,[173],{"type":16,"tag":131,"props":174,"children":175},{"style":138},[176],{"type":21,"value":177},"[+] Setting threshold to: 9001\n",{"type":16,"tag":131,"props":179,"children":181},{"class":133,"line":180},6,[182],{"type":16,"tag":131,"props":183,"children":184},{"style":138},[185],{"type":21,"value":186},"[+] Setting the number of shares to: 9000\n",{"type":16,"tag":131,"props":188,"children":190},{"class":133,"line":189},7,[191],{"type":16,"tag":131,"props":192,"children":193},{"style":138},[194],{"type":21,"value":195},"[+] Got the shares\n",{"type":16,"tag":131,"props":197,"children":199},{"class":133,"line":198},8,[200,205,211],{"type":16,"tag":131,"props":201,"children":202},{"style":138},[203],{"type":21,"value":204},"[",{"type":16,"tag":131,"props":206,"children":208},{"style":207},"--shiki-default:#F92672",[209],{"type":21,"value":210},"*",{"type":16,"tag":131,"props":212,"children":213},{"style":138},[214],{"type":21,"value":215},"] Cracking secret...\n",{"type":16,"tag":131,"props":217,"children":219},{"class":133,"line":218},9,[220],{"type":16,"tag":131,"props":221,"children":222},{"style":138},[223],{"type":21,"value":224},"[+] Finished cracking with status 0\n",{"type":16,"tag":131,"props":226,"children":228},{"class":133,"line":227},10,[229],{"type":16,"tag":131,"props":230,"children":231},{"style":138},[232],{"type":21,"value":233},"[+] Got secret 33204634315060132722370276963862036606806159174093789534175596021531768399803\n",{"type":16,"tag":131,"props":235,"children":237},{"class":133,"line":236},11,[238,243],{"type":16,"tag":131,"props":239,"children":240},{"style":138},[241],{"type":21,"value":242},"[+] Got from server: ",{"type":16,"tag":131,"props":244,"children":246},{"style":245},"--shiki-default:#E6DB74",[247],{"type":21,"value":248},"'33204634315060132722370276963862036606806159174093789534175596021531768399803\n",{"type":16,"tag":131,"props":250,"children":252},{"class":133,"line":251},12,[253],{"type":16,"tag":131,"props":254,"children":255},{"style":245},[256],{"type":21,"value":257},"'\n",{"type":16,"tag":131,"props":259,"children":261},{"class":133,"line":260},13,[262,266],{"type":16,"tag":131,"props":263,"children":264},{"style":138},[265],{"type":21,"value":242},{"type":16,"tag":131,"props":267,"children":268},{"style":245},[269],{"type":21,"value":270},"'flag{i_cant_believe_someone_else_found_a_cheese}\n",{"type":16,"tag":131,"props":272,"children":274},{"class":133,"line":273},14,[275],{"type":16,"tag":131,"props":276,"children":277},{"style":245},[278],{"type":21,"value":257},{"type":16,"tag":131,"props":280,"children":282},{"class":133,"line":281},15,[283],{"type":16,"tag":131,"props":284,"children":285},{"style":138},[286],{"type":21,"value":287},"[+] Closed\n",{"type":16,"tag":131,"props":289,"children":291},{"class":133,"line":290},16,[292,296,300],{"type":16,"tag":131,"props":293,"children":294},{"style":138},[295],{"type":21,"value":204},{"type":16,"tag":131,"props":297,"children":298},{"style":207},[299],{"type":21,"value":210},{"type":16,"tag":131,"props":301,"children":302},{"style":138},[303],{"type":21,"value":304},"] Closed connection to crypto.chal.csaw.io port 1000\n",{"type":16,"tag":306,"props":307,"children":308},"style",{},[309],{"type":21,"value":310},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",{"title":7,"searchDepth":144,"depth":144,"links":312},[313,314],{"id":37,"depth":144,"text":40},{"id":62,"depth":144,"text":65},"markdown","content:blog:csaw-final19-sharing-is-caring.md","content","blog/csaw-final19-sharing-is-caring.md","md",1717913475732]