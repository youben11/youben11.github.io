{"_path":"/blog/csaw-final19-sharing-is-caring","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"CSAW'19 CTF Finals Writeup - Sharing is Caring","description":"Cyber Security Awareness Worldwide is the most comprehensive student-run cyber security event in the world, featuring nine competitions, 6 global hosts, workshops, and industry events.","date":"2019-11-11T00:00:00.000Z","image":"/img/csaw-ctf-logo.png","draft":false,"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Last week we ("},{"type":"element","tag":"a","props":{"href":"https://twitter.com/Sudo_root_team","rel":["nofollow"]},"children":[{"type":"text","value":"Sudo_root"}]},{"type":"text","value":") played the CSAW'19 CTF in the MENA region and got the second place, the challenges were great and full of crypto, I personally liked the sharing is caring challenge which was worth 500 points so I'm making a writeup about it."}]},{"type":"element","tag":"h2","props":{"id":"challenge-description"},"children":[{"type":"text","value":"Challenge description"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The challenge tells us that 'sharing is caring!' and it was just hinting that the challenge was about a secret sharing scheme. The goal was to recover the secret under certain conditions, the most basic one is that we can only get up to threshold-1 shares (otherwise the challenge would be about doing calculations), however, we were able to find an additional free share and thus recover the secret really easily."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The challenge provided a Python2 code that was running on the remote server and you can find it "},{"type":"element","tag":"a","props":{"href":"https://github.com/osirislab/CSAW-CTF-2019-Finals/blob/master/crypto/sharing_is_caring/sharing_is_caring.py","rel":["nofollow"]},"children":[{"type":"text","value":"here"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"solution"},"children":[{"type":"text","value":"Solution"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"So the challenge was about secret sharing using polynoms, where single points were complex numbers,\nthe app server asks us to provide a polynom of degree higher or equal to 9000 (minimum threshold is 9001) and a threshold higher than 9000 and asks us about how many share we need, we can get up to THRESHOLD-1 shares, so the best is to have the maximum number of shares so we need to recover only one share to be able to get the secret. The main thing that I noticed is that no matters what polynom we provide, it will always map the value i=0 with the point (a0,0) (a0 is the coefficient of x^0 from our polynom), and since a0 is 0 in our case, this will just be a free share that we can use to do lagrange interpolation and recover the secret."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The solution script for this challenge can be found "},{"type":"element","tag":"a","props":{"href":"https://github.com/youben11/Writeups/tree/master/csaw_19_finals_sharing_is_caring_crypto500","rel":["nofollow"]},"children":[{"type":"text","value":"here"}]},{"type":"text","value":", the main script is solve.py which will use a second sage script to do the heavy math. Basically the script will do the following:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"get the prime number used"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"send the polynom, threshold and the number of shares to get"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"get the shares and save them into files so the second script uses them"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"run the lag.sage script to do the heavy math and recover the secret"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"send the secret and get the flag!"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Below is the execution of solve.py"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes monokai","code":"[youben@ym sharing_is_caring]$ python2 solve.py \n[+] Opening connection to crypto.chal.csaw.io on port 1000: Done\n[+] Got prime 86279386867068376297302505847424156586494550934111236939596248557564380476339\n[+] Setting polynom to: 5x^1 + 87x^9000\n[+] Setting threshold to: 9001\n[+] Setting the number of shares to: 9000\n[+] Got the shares\n[*] Cracking secret...\n[+] Finished cracking with status 0\n[+] Got secret 33204634315060132722370276963862036606806159174093789534175596021531768399803\n[+] Got from server: '33204634315060132722370276963862036606806159174093789534175596021531768399803\n'\n[+] Got from server: 'flag{i_cant_believe_someone_else_found_a_cheese}\n'\n[+] Closed\n[*] Closed connection to crypto.chal.csaw.io port 1000\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[youben@ym sharing_is_caring]$ python2 solve.py \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Opening connection to crypto.chal.csaw.io on port 1000: Done\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Got prime 86279386867068376297302505847424156586494550934111236939596248557564380476339\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Setting polynom to: 5x^1 + 87x^9000\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Setting threshold to: 9001\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Setting the number of shares to: 9000\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Got the shares\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] Cracking secret...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Finished cracking with status 0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Got secret 33204634315060132722370276963862036606806159174093789534175596021531768399803\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Got from server: "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"'33204634315060132722370276963862036606806159174093789534175596021531768399803\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Got from server: "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"'flag{i_cant_believe_someone_else_found_a_cheese}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] Closed\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] Closed connection to crypto.chal.csaw.io port 1000\n"}]}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"challenge-description","depth":2,"text":"Challenge description"},{"id":"solution","depth":2,"text":"Solution"}]}},"_type":"markdown","_id":"content:blog:csaw-final19-sharing-is-caring.md","_source":"content","_file":"blog/csaw-final19-sharing-is-caring.md","_extension":"md"}