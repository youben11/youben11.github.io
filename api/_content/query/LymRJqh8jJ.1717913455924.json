{"_path":"/blog/mctf-2019-back-to-the-old-days","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"MCTF Final 2019 Writeup - Back to the Old Ways","description":"There is a group of hackers that we've been trying to take down for a while, we had a spy among them but his cover was compromised, but he managed to leak a piece of code...","date":"2019-07-30T00:00:00.000Z","image":"/img/mctffinal2019.jpg","draft":false,"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I played MCTF final 2019 with "},{"type":"element","tag":"a","props":{"href":"https://web.facebook.com/sud0r00t/","rel":["nofollow"]},"children":[{"type":"text","value":"my team"}]},{"type":"text","value":" this week and wanted to share a writeup for the 'Back to the old ways' crypto challenge."}]},{"type":"element","tag":"h2","props":{"id":"challenge-description"},"children":[{"type":"text","value":"Challenge description"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There is a group of hackers that we've been trying to take down for a while, we had a spy among them but his cover was compromised, but he managed to leak a piece of code running on their main socket, try to get admin access."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"nc 52.59.5.86 1111"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Objective:"}]},{"type":"text","value":" Get admin access"}]},{"type":"element","tag":"h2","props":{"id":"solution"},"children":[{"type":"text","value":"Solution"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I first tried to use the public service"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes monokai","code":"[youben@ym ~]$ ncat 52.59.5.86 1111\n[1] register\n[2] login\n1\n[+] name:\nyouben\n[+] password:\npassword\n[+] this is your hex-encoded cookie: 6625205b724457776f2e753f7c3463542a3f584254547d6a77493c0b09714c3a2761476358606a6e45653a5d\n[1] register\n[2] login\n2\n[+] cookie(in hex):\n6625205b724457776f2e753f7c3463542a3f584254547d6a77493c0b09714c3a2761476358606a6e45653a5d\n[-] access is for admins only\n[1] register\n[2] login\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[youben@ym "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"~"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"]$ ncat 52.59.5.86 1111\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] register\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] login\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] name:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":"youben\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] password:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":"password\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] this is your hex-encoded cookie: 6625205b724457776f2e753f7c3463542a3f584254547d6a77493c0b09714c3a2761476358606a6e45653a5d\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] register\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] login\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":"2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] cookie(in hex):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":"6625205b724457776f2e753f7c3463542a3f584254547d6a77493c0b09714c3a2761476358606a6e45653a5d\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[-] access is "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" admins only\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] register\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] login\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It seems like our information are stored in that cookie and are checked when we try to login to see if we have admin rights. So the goal is to construct a valid admin cookie. Let's check the provided code"}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes monokai","code":"#all what u need is here\n\nfrom string import printable as alpha\n\ndef encrypt(msg,key,iv):\n    if len(msg) % 11 != 0:\n        msg += alpha[len(msg) % 11] * (11 - len(msg) % 11)\n    l = [msg[i:i+11] for i in range(0,len(msg),11)]\n    ct = []\n    for i in l:\n        tmp = viginereEncrypt(i,iv)\n        tmp = railFenceEncrypt(tmp,key)\n        ct.append(tmp)\n        iv = tmp\n    return ''.join(ct)\n\ndef decrypt(msg,key,iv):\n    l = [msg[i:i+11] for i in range(0,len(msg),11)]\n    pt = []\n    for i in l:\n        tmp = railFenceDecrypt(i,key)\n        tmp = viginereDecrypt(tmp,iv)\n        pt.append(tmp)\n        iv = i\n    return ''.join(pt)\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#88846F"},"children":[{"type":"text","value":"#all what u need is here\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" string "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" printable "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" alpha\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":" encrypt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"msg"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"iv"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(msg) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":" !="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        msg "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" alpha["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(msg) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(msg) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    l "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" [msg[i:i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(msg),"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":")]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    ct "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" []\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" l:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        tmp "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" viginereEncrypt(i,iv)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        tmp "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" railFenceEncrypt(tmp,key)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        ct.append(tmp)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        iv "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" tmp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" ''"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":".join(ct)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":" decrypt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"msg"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"iv"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    l "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" [msg[i:i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(msg),"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":")]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    pt "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" []\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" l:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        tmp "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" railFenceDecrypt(i,key)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        tmp "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" viginereDecrypt(tmp,iv)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        pt.append(tmp)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        iv "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" ''"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":".join(pt)\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The encryption can be illustrated in the figure below"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"cbc","src":"/img/cbc.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It's using vigenere and railfence in "},{"type":"element","tag":"a","props":{"href":"https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation","rel":["nofollow"]},"children":[{"type":"text","value":"CBC"}]},{"type":"text","value":" mode, the keyspace for railfence here is computable (only 10 possible keys), so if we know the last plaintext then we can just try decrypting the last ciphertext with the possible keys until we found the correct one that decrypts to our know plaintext, thanks to the padding for that, if len(plaintext) % 11 == 1 then it will be padded with 10 '1', however, we must first understand how it's constructing the plaintext cookie."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Trying different inputs, I discovered that a name and password of length 6 + 11k gives us a padding of 10 '1', so we can now decrypt the last block with the 10 possible keys and check until we get those 10 '1' and decrypt the whole cookie except the first block cause we don't have the IV."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Decrypting the cookie gave me '](yv$zHX?B)&password=&admin=false&1111111111', seems like we only need to replace that 'false' with a 'true' and reconstruct a valid cookie. You can check the complete code for doing that below"}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes monokai","code":"from string import printable as alpha\nfrom binascii import unhexlify, hexlify\n\n\ndef encryptRailFence(text, key):\n    rail = [['\\n' for i in range(len(text))]\n                  for j in range(key)]\n    dir_down = False\n    row, col = 0, 0\n\n    for i in range(len(text)):\n        if (row == 0) or (row == key - 1):\n            dir_down = not dir_down\n\n        rail[row][col] = text[i]\n        col += 1\n        if dir_down:\n            row += 1\n        else:\n            row -= 1\n    result = []\n    for i in range(key):\n        for j in range(len(text)):\n            if rail[i][j] != '\\n':\n                result.append(rail[i][j])\n    return(\"\" . join(result))\n\n\ndef decryptRailFence(cipher, key):\n    rail = [['\\n' for i in range(len(cipher))]\n                  for j in range(key)]\n    dir_down = None\n    row, col = 0, 0\n\n    for i in range(len(cipher)):\n        if row == 0:\n            dir_down = True\n        if row == key - 1:\n            dir_down = False\n\n        rail[row][col] = '*'\n        col += 1\n\n        if dir_down:\n            row += 1\n        else:\n            row -= 1\n    index = 0\n    for i in range(key):\n        for j in range(len(cipher)):\n            if ((rail[i][j] == '*') and\n               (index < len(cipher))):\n                rail[i][j] = cipher[index]\n                index += 1\n    result = []\n    row, col = 0, 0\n    for i in range(len(cipher)):\n        if row == 0:\n            dir_down = True\n        if row == key-1:\n            dir_down = False\n        if (rail[row][col] != '*'):\n            result.append(rail[row][col])\n            col += 1\n        if dir_down:\n            row += 1\n        else:\n            row -= 1\n    return(\"\".join(result))\n\n\ndef decryptVig(ciphertext, key):\n    key_length = len(key)\n    key_as_int = [alpha.find(k) for k in key]\n    ciphertext_int = [alpha.find(c) for c in ciphertext]\n    plaintext = ''\n    for i in range(len(ciphertext_int)):\n        p = (ciphertext_int[i] - key_as_int[i % key_length]) % len(alpha)\n        plaintext += alpha[p]\n    return plaintext\n\n\ndef encryptVig(plaintext, key):\n    key_length = len(key)\n    key_as_int = [alpha.find(k) for k in key]\n    plaintext_int = [alpha.find(p) for p in plaintext]\n    ciphertext = ''\n    for i in range(len(plaintext_int)):\n        c = (plaintext_int[i] + key_as_int[i % key_length]) % len(alpha)\n        ciphertext += alpha[c]\n    return ciphertext\n\n\ndef decrypt(msg,key,iv):\n    l = [msg[i:i+11] for i in range(0,len(msg),11)]\n    pt = []\n    for i in l:\n        tmp = decryptRailFence(i,key)\n        tmp = decryptVig(tmp,iv)\n        pt.append(tmp)\n        iv = i\n    return ''.join(pt)\n\n\nif __name__ == '__main__':\n    # name: 'aaaaaa'\n    # password: ''\n    expected_chars = '1' * 10\n    cookie = \"2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d7a73530c0b66227736200b4174540c30\"\n    cipher = unhexlify(cookie).decode()\n    ciphers = [cipher[i:i+11] for i in range(0, len(cipher), 11)]\n    last_cipher = ciphers[-1]\n    rf_key = -1\n    for i in range(2, 11):\n        p = decryptRailFence(last_cipher, i)\n        p = decryptVig(p, ciphers[-2])\n        if expected_chars in p:\n            print(\"Found RF key: %d\" % i)\n            rf_key = i\n    print(decrypt(cipher, rf_key, \"0\"))\n    admin_val = \"admin=true&\"\n    # construct the admin cookie\n    cons = encryptVig(admin_val, ciphers[-3])\n    cons = encryptRailFence(cons, rf_key)\n    ciphers[-2] = cons\n    # print admin cookie\n    print(hexlify(''.join(ciphers[:-1]).encode()))\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" string "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" printable "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" alpha\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" binascii "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" unhexlify, hexlify\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":" encryptRailFence"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"text"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    rail "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" [["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":" for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(text))]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"                  for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" j "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(key)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    dir_down "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" False\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    row, col "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(text)):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" (row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"or"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" (row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" key "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            dir_down "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":" not"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" dir_down\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        rail[row][col] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" text[i]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        col "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" dir_down:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        else"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    result "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" []\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(key):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" j "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(text)):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"            if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" rail[i][j] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"!="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" '"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"                result.append(rail[i][j])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"\"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" . join(result))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":" decryptRailFence"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"cipher"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    rail "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" [["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":" for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(cipher))]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"                  for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" j "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(key)]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    dir_down "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" None\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    row, col "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(cipher)):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            dir_down "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" True\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" key "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            dir_down "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" False\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        rail[row][col] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" '*'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        col "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" dir_down:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        else"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    index "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(key):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" j "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(cipher)):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"            if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" ((rail[i][j] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" '*'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"and\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"               (index "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(cipher))):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"                rail[i][j] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" cipher[index]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"                index "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    result "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" []\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    row, col "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"0\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(cipher)):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            dir_down "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" True\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            dir_down "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" False\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" (rail[row][col] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"!="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" '*'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            result.append(rail[row][col])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            col "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" dir_down:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        else"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            row "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"\"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":".join(result))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":70},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":71},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":72},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":" decryptVig"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"ciphertext"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":73},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    key_length "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(key)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":74},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    key_as_int "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" [alpha.find(k) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" k "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" key]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":75},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    ciphertext_int "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" [alpha.find(c) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" c "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" ciphertext]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":76},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    plaintext "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" ''\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":77},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(ciphertext_int)):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":78},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        p "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" (ciphertext_int[i] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" key_as_int[i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" key_length]) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(alpha)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":79},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        plaintext "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" alpha[p]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":80},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" plaintext\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":81},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":82},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":83},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":" encryptVig"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"plaintext"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":84},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    key_length "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(key)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":85},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    key_as_int "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" [alpha.find(k) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" k "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" key]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":86},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    plaintext_int "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" [alpha.find(p) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" p "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" plaintext]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":87},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    ciphertext "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" ''\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":88},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(plaintext_int)):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":89},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        c "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" (plaintext_int[i] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" key_as_int[i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" key_length]) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"%"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(alpha)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":90},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        ciphertext "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" alpha[c]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":91},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" ciphertext\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":92},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":93},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":94},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":" decrypt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"msg"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#FD971F;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"iv"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":95},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    l "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" [msg[i:i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(msg),"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":")]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":96},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    pt "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" []\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":97},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" l:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":98},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        tmp "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" decryptRailFence(i,key)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":99},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        tmp "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" decryptVig(tmp,iv)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":100},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        pt.append(tmp)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":101},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        iv "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":102},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" ''"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":".join(pt)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":103},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":104},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":105},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" __name__ "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" '__main__'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":106},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#88846F"},"children":[{"type":"text","value":"    # name: 'aaaaaa'\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":107},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#88846F"},"children":[{"type":"text","value":"    # password: ''\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":108},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    expected_chars "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" '1'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":" *"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":" 10\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":109},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    cookie "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" \"2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d7a73530c0b66227736200b4174540c30\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":110},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    cipher "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" unhexlify(cookie).decode()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":111},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    ciphers "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" [cipher[i:i"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(cipher), "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":")]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":112},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    last_cipher "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" ciphers["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":113},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    rf_key "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":" -"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":114},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"    for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":" range"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"11"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":115},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        p "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" decryptRailFence(last_cipher, i)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":116},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"        p "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" decryptVig(p, ciphers["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":117},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"        if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" expected_chars "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" p:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":118},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"            print"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"\"Found RF key: "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"%d"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":" %"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":119},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"            rf_key "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" i\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":120},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"    print"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(decrypt(cipher, rf_key, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"\"0\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":121},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    admin_val "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":" \"admin=true&\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":122},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#88846F"},"children":[{"type":"text","value":"    # construct the admin cookie\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":123},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    cons "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" encryptVig(admin_val, ciphers["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"3"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":124},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    cons "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" encryptRailFence(cons, rf_key)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":125},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"    ciphers["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":" cons\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":126},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#88846F"},"children":[{"type":"text","value":"    # print admin cookie\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":127},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#66D9EF"},"children":[{"type":"text","value":"    print"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"(hexlify("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"''"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":".join(ciphers[:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"]).encode()))\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finally, I only got a new cookie by registering, constructed a valid admin cookie from it, used it to login and get the flag :)"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes monokai","code":"[youben@ym ~]$ ncat 52.59.5.86 1111\n[1] register\n[2] login\n1\n[+] name:\naaaaaa\n[+] password:\n\n[+] this is your hex-encoded cookie: 2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d7a73530c0b66227736200b4174540c30\n[1] register\n[2] login\n2\n[+] cookie(in hex):\n2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d4e4a22515b\nMCTF{mochi_mochi,CBC desu?!}\n[1] register\n[2] login\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[youben@ym "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F92672"},"children":[{"type":"text","value":"~"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"]$ ncat 52.59.5.86 1111\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] register\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] login\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":"1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] name:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":"aaaaaa\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] password:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] this is your hex-encoded cookie: 2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d7a73530c0b66227736200b4174540c30\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] register\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] login\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":"2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"[+] cookie(in hex):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":"2a6f0c58475c0a7c6b3533434e395e29686b6978295c4d2176357e0d4e4a22515b\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A6E22E"},"children":[{"type":"text","value":"MCTF"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"{mochi_mochi,CBC "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E6DB74"},"children":[{"type":"text","value":"desu?!}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] register\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AE81FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F8F8F2"},"children":[{"type":"text","value":"] login\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Thanks to "},{"type":"element","tag":"a","props":{"href":"https://www.facebook.com/th3jackers","rel":["nofollow"]},"children":[{"type":"text","value":"th3jackers"}]},{"type":"text","value":" for the nice challenge."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"challenge-description","depth":2,"text":"Challenge description"},{"id":"solution","depth":2,"text":"Solution"}]}},"_type":"markdown","_id":"content:blog:mctf-2019-back-to-the-old-days.md","_source":"content","_file":"blog/mctf-2019-back-to-the-old-days.md","_extension":"md"}